{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1",
      "unitTestNullDataMigrated" : true
    },
    "functions" : {
      "columnExpressions" : {
        "expressions" : [ ],
        "sharedExpressions" : [ ]
      }
    },
    "codeGenConfiguration" : {
      "editableConfig" : true,
      "plibVersion" : {
        "mavenVersion" : "8.13.2",
        "pyPiVersion" : "2.1.5"
      },
      "sparkConfigJinjaEnabled" : true
    },
    "id" : "1",
    "uri" : "pipelines/test2_cg",
    "sourceSuggestions" : [ ],
    "pipelineSettingsInfo" : {
      "applicationName" : "tao_poc_ingest_raw_into_copper_and_create_view",
      "hasApplication" : true,
      "isFunctionsPackageDirDefined" : true,
      "isNullValuesInUnitTestsEnabled" : true,
      "sparkConfigOptions" : {
        "disableSparkCreationTimeConfigGeneration" : true
      }
    },
    "language" : "python",
    "fabricId" : "35322",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "geechrisprophecyioteam.temp1cg.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "var_raw_container",
          "kind" : {
            "type" : "string",
            "value" : "raw"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_raw_storage_account",
          "kind" : {
            "type" : "string",
            "value" : "chris_demos"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_copper_container",
          "kind" : {
            "type" : "string",
            "value" : "copper"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_delta_storage_account",
          "kind" : {
            "type" : "string",
            "value" : "chris_demos"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_catalog_name",
          "kind" : {
            "type" : "string",
            "value" : "chris_demos"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_etl_schema",
          "kind" : {
            "type" : "string",
            "value" : "etl"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_log_schema",
          "kind" : {
            "type" : "string",
            "value" : "log"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_bus_dt",
          "kind" : {
            "type" : "string",
            "value" : "20250929"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_copper_schema",
          "kind" : {
            "type" : "string",
            "value" : "copper"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_log_container",
          "kind" : {
            "type" : "string",
            "value" : "log"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_warning_type",
          "kind" : {
            "type" : "string",
            "value" : "WARNING"
          },
          "optional" : false,
          "comment" : "",
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_info_type",
          "kind" : {
            "type" : "string",
            "value" : "INFO"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_error_type",
          "kind" : {
            "type" : "string",
            "value" : "ERROR"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_file_check",
          "kind" : {
            "type" : "string",
            "value" : "FILE_CHECK"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_critical_file",
          "kind" : {
            "type" : "string",
            "value" : "CRITICAL_FILE_CHECK"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_row_count",
          "kind" : {
            "type" : "string",
            "value" : "ROW_COUNT"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_log_type_generic",
          "kind" : {
            "type" : "string",
            "value" : "GENERIC"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_bus_dt_dt",
          "kind" : {
            "type" : "string",
            "value" : "20250929"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_wkf_name",
          "kind" : {
            "type" : "string",
            "value" : "executed from Prophecy"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_task_name",
          "kind" : {
            "type" : "string",
            "value" : "tao_incremental_ingestion_csv"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_task_run_id",
          "kind" : {
            "type" : "string",
            "value" : "executed from Prophecy"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_wkf_run_id",
          "kind" : {
            "type" : "string",
            "value" : "executed from Prophecy"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_start_timestamp",
          "kind" : {
            "type" : "string",
            "value" : "1900-01-01 00:00:00"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_src_tao_sfic",
          "kind" : {
            "type" : "string",
            "value" : "TAO_SFIC_G"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_src_tao_snow",
          "kind" : {
            "type" : "string",
            "value" : "tao_snow"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_src_tao_8fold",
          "kind" : {
            "type" : "string",
            "value" : "tao_8fold"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_matching_files",
          "kind" : {
            "type" : "boolean",
            "value" : false
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_aux_insert_datetime",
          "kind" : {
            "type" : "string",
            "value" : "aux_ins_dtm"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_aux_updated_datetime",
          "kind" : {
            "type" : "string",
            "value" : "aux_upd_dtm"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_aux_extract_bus_date",
          "kind" : {
            "type" : "string",
            "value" : "aux_extract_bus_dt"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_aux_updated_extract_bus_date",
          "kind" : {
            "type" : "string",
            "value" : "aux_upd_extract_bus_dt"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_extract_bus_dt_tao_sfic",
          "kind" : {
            "type" : "string",
            "value" : "20251001"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "var_full_load_mode_sfic_tao",
          "kind" : {
            "type" : "string",
            "value" : "1"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "Full_Load",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "bronze_table",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "raw_file_path",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_prefix",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "encryption_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "field_separator",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "part_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "keys_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "headers_in_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "full_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "inc_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "critical",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "business_keys",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "tie_breaker_column",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "enabled",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ins_dtm",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "var_raw_container",
              "kind" : {
                "type" : "string",
                "value" : "raw"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_raw_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_container",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_delta_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_etl_schema",
              "kind" : {
                "type" : "string",
                "value" : "etl"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_schema",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_container",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_warning_type",
              "kind" : {
                "type" : "string",
                "value" : "WARNING"
              },
              "optional" : false,
              "comment" : "",
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_info_type",
              "kind" : {
                "type" : "string",
                "value" : "INFO"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_error_type",
              "kind" : {
                "type" : "string",
                "value" : "ERROR"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_file_check",
              "kind" : {
                "type" : "string",
                "value" : "FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_name",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_name",
              "kind" : {
                "type" : "string",
                "value" : "tao_incremental_ingestion_csv"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_start_timestamp",
              "kind" : {
                "type" : "string",
                "value" : "1900-01-01 00:00:00"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "TAO_SFIC_G"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_snow",
              "kind" : {
                "type" : "string",
                "value" : "tao_snow"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_8fold",
              "kind" : {
                "type" : "string",
                "value" : "tao_8fold"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_matching_files",
              "kind" : {
                "type" : "boolean",
                "value" : false
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_insert_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_ins_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_extract_bus_dt_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "20251001"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_type_generic",
              "kind" : {
                "type" : "string",
                "value" : "GENERIC"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_schema",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_critical_file",
              "kind" : {
                "type" : "string",
                "value" : "CRITICAL_FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_row_count",
              "kind" : {
                "type" : "string",
                "value" : "ROW_COUNT"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_full_load_mode_sfic_tao",
              "kind" : {
                "type" : "string",
                "value" : "1"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "Full_Load_for_Inc",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "bronze_table",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "raw_file_path",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_prefix",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "encryption_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "field_separator",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "part_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "keys_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "headers_in_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "full_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "inc_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "critical",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "business_keys",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "tie_breaker_column",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "enabled",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ins_dtm",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "var_raw_container",
              "kind" : {
                "type" : "string",
                "value" : "raw"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_raw_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_container",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_delta_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_etl_schema",
              "kind" : {
                "type" : "string",
                "value" : "etl"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_schema",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_container",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_warning_type",
              "kind" : {
                "type" : "string",
                "value" : "WARNING"
              },
              "optional" : false,
              "comment" : "",
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_info_type",
              "kind" : {
                "type" : "string",
                "value" : "INFO"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_error_type",
              "kind" : {
                "type" : "string",
                "value" : "ERROR"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_file_check",
              "kind" : {
                "type" : "string",
                "value" : "FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_name",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_name",
              "kind" : {
                "type" : "string",
                "value" : "tao_incremental_ingestion_csv"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_start_timestamp",
              "kind" : {
                "type" : "string",
                "value" : "1900-01-01 00:00:00"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "TAO_SFIC_G"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_snow",
              "kind" : {
                "type" : "string",
                "value" : "tao_snow"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_8fold",
              "kind" : {
                "type" : "string",
                "value" : "tao_8fold"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_matching_files",
              "kind" : {
                "type" : "boolean",
                "value" : false
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_insert_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_ins_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_extract_bus_dt_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "20251001"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_type_generic",
              "kind" : {
                "type" : "string",
                "value" : "GENERIC"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_schema",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_full_load_mode_sfic_tao",
              "kind" : {
                "type" : "string",
                "value" : "1"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "Inc_Load_for_Inc",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "bronze_table",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "raw_file_path",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_prefix",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "encryption_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "field_separator",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "part_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "keys_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "headers_in_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "full_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "inc_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "critical",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "business_keys",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "tie_breaker_column",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "enabled",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ins_dtm",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "var_raw_container",
              "kind" : {
                "type" : "string",
                "value" : "raw"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_raw_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_container",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_delta_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_etl_schema",
              "kind" : {
                "type" : "string",
                "value" : "etl"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_schema",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_container",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_warning_type",
              "kind" : {
                "type" : "string",
                "value" : "WARNING"
              },
              "optional" : false,
              "comment" : "",
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_info_type",
              "kind" : {
                "type" : "string",
                "value" : "INFO"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_error_type",
              "kind" : {
                "type" : "string",
                "value" : "ERROR"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_file_check",
              "kind" : {
                "type" : "string",
                "value" : "FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_name",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_name",
              "kind" : {
                "type" : "string",
                "value" : "tao_incremental_ingestion_csv"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_start_timestamp",
              "kind" : {
                "type" : "string",
                "value" : "1900-01-01 00:00:00"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "TAO_SFIC_G"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_snow",
              "kind" : {
                "type" : "string",
                "value" : "tao_snow"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_8fold",
              "kind" : {
                "type" : "string",
                "value" : "tao_8fold"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_matching_files",
              "kind" : {
                "type" : "boolean",
                "value" : false
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_insert_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_ins_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_extract_bus_dt_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "20251001"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_type_generic",
              "kind" : {
                "type" : "string",
                "value" : "GENERIC"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_schema",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_full_load_mode_sfic_tao",
              "kind" : {
                "type" : "string",
                "value" : "1"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_critical_file",
              "kind" : {
                "type" : "string",
                "value" : "CRITICAL_FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_row_count",
              "kind" : {
                "type" : "string",
                "value" : "ROW_COUNT"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "Keys_Load_for_Inc",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "bronze_table",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "raw_file_path",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_prefix",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "file_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "encryption_type",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "field_separator",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "part_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "keys_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "headers_in_file",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "full_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "inc_load",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "critical",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "business_keys",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "tie_breaker_column",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "enabled",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ins_dtm",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "var_raw_container",
              "kind" : {
                "type" : "string",
                "value" : "raw"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_raw_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_container",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_delta_storage_account",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "chris_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_etl_schema",
              "kind" : {
                "type" : "string",
                "value" : "etl"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_copper_schema",
              "kind" : {
                "type" : "string",
                "value" : "copper"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_container",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_warning_type",
              "kind" : {
                "type" : "string",
                "value" : "WARNING"
              },
              "optional" : false,
              "comment" : "",
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_info_type",
              "kind" : {
                "type" : "string",
                "value" : "INFO"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_error_type",
              "kind" : {
                "type" : "string",
                "value" : "ERROR"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_file_check",
              "kind" : {
                "type" : "string",
                "value" : "FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_bus_dt_dt",
              "kind" : {
                "type" : "string",
                "value" : "20250929"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_name",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_name",
              "kind" : {
                "type" : "string",
                "value" : "tao_incremental_ingestion_csv"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_task_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_wkf_run_id",
              "kind" : {
                "type" : "string",
                "value" : "executed from Prophecy"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_start_timestamp",
              "kind" : {
                "type" : "string",
                "value" : "1900-01-01 00:00:00"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "TAO_SFIC_G"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_snow",
              "kind" : {
                "type" : "string",
                "value" : "tao_snow"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_src_tao_8fold",
              "kind" : {
                "type" : "string",
                "value" : "tao_8fold"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_matching_files",
              "kind" : {
                "type" : "boolean",
                "value" : false
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_insert_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_ins_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_datetime",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_dtm"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_aux_updated_extract_bus_date",
              "kind" : {
                "type" : "string",
                "value" : "aux_upd_extract_bus_dt"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_extract_bus_dt_tao_sfic",
              "kind" : {
                "type" : "string",
                "value" : "20251001"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_type_generic",
              "kind" : {
                "type" : "string",
                "value" : "GENERIC"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_log_schema",
              "kind" : {
                "type" : "string",
                "value" : "log"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_full_load_mode_sfic_tao",
              "kind" : {
                "type" : "string",
                "value" : "1"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_critical_file",
              "kind" : {
                "type" : "string",
                "value" : "CRITICAL_FILE_CHECK"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            }, {
              "name" : "var_row_count",
              "kind" : {
                "type" : "string",
                "value" : "ROW_COUNT"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ {
      "name" : "spark.default.parallelism",
      "value" : "4"
    }, {
      "name" : "spark.sql.legacy.allowUntypedScalaUDF",
      "value" : "true"
    } ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Selective",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "tao_incremental_ingestion_csv",
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "B3eN3O9keA5azQRI9-rqd",
    "source" : "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48",
    "sourcePort" : "lYWc6ksfH0dDgmO4HRQav$$IXjBkK0Szh7jv9YJGpsE9",
    "target" : "8hr_tkGBtv5FwE0nVYih7$$KGCe8lxADUkdvzPqyA1l6",
    "targetPort" : "uhIMgKK8oUCuRzibzjjzA$$2rWUJmOkUdz6iuKc7mbsX"
  }, {
    "id" : "fTkBKgYzes5wFVk8p0D2j",
    "source" : "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48",
    "sourcePort" : "lYWc6ksfH0dDgmO4HRQav$$IXjBkK0Szh7jv9YJGpsE9",
    "target" : "tvAjagAIEmo1bdPNzoNhA$$dUx2ZnCRv0r2VktLAeOti",
    "targetPort" : "A6qNF3lh3lnTWvTps9GyY$$zl1mYa8Y1KjUuZw6_uZLc"
  }, {
    "id" : "SJ2f4bPNok-BYCNDNmcNz",
    "source" : "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48",
    "sourcePort" : "lYWc6ksfH0dDgmO4HRQav$$IXjBkK0Szh7jv9YJGpsE9",
    "target" : "bRhTb1RslvcMf7h2t2EZq$$FC0q6-h_t4rvbp6HN8KDC",
    "targetPort" : "ezD-AmWasBSI_-7gj8UZK$$DPIEehU-5MJa0w0Z-w9lB"
  }, {
    "id" : "BrXtdBNEfVnvuXJDUNOjV",
    "source" : "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48",
    "sourcePort" : "lYWc6ksfH0dDgmO4HRQav$$IXjBkK0Szh7jv9YJGpsE9",
    "target" : "aYh0xCywT-3RjcGP_nkMZ$$jmyeHKLuR7J6cXl6ALyGP",
    "targetPort" : "vXuMuQ1l-DavhEm0F5O5r$$Vus58OKxipeuXn2_vYLXz"
  }, {
    "id" : "SHQl9cSHXs8QMjq_M01VO",
    "source" : "aYh0xCywT-3RjcGP_nkMZ$$jmyeHKLuR7J6cXl6ALyGP",
    "sourcePort" : "Elei47HzyTL4N-iqemdt1$$dzLoCnL_9GrfRlIJ4O9CA",
    "target" : "4LzTbrWQMrDIhFm6GoQjt$$in1HqEgVQvoYNcwiPiwcg",
    "targetPort" : "Kp4wBtPNrxsQNwYr4vknT$$D7ZOGo-mCnRF80t65em2g"
  }, {
    "id" : "pLEz5JsHFoDhlM3dwCxhs",
    "source" : "bRhTb1RslvcMf7h2t2EZq$$FC0q6-h_t4rvbp6HN8KDC",
    "sourcePort" : "yMppAXi9xDH68k4nd_qtq$$v3zoON491kVHSbuK6EYmz",
    "target" : "1usNRQ4J9VWFYir1FBng-$$ilfhRBrfVU-b6156F6UqC",
    "targetPort" : "bxI1fWaP5LLPEW6Gdbkdw$$2HlXXfCUpdS4SRHgX-2PJ"
  }, {
    "id" : "y3agqlr9CVwDb9cKJgMA6",
    "source" : "tvAjagAIEmo1bdPNzoNhA$$dUx2ZnCRv0r2VktLAeOti",
    "sourcePort" : "ko6oIQJj9A3j3psEoIObT$$ktj2lAD0I5CaPTPVwuqQj",
    "target" : "x9UaY2J7gSIcPt4uBIbug$$zeQIlSpGQSDcmCnNtrSNS",
    "targetPort" : "0EfUC57-vP4u0lDzETIc9$$RZ_eFzhjcy_eO4XVgC6n2"
  } ],
  "processes" : {
    "bRhTb1RslvcMf7h2t2EZq$$FC0q6-h_t4rvbp6HN8KDC" : {
      "id" : "bRhTb1RslvcMf7h2t2EZq$$FC0q6-h_t4rvbp6HN8KDC",
      "component" : "Filter",
      "metadata" : {
        "label" : "Inc_Control_Table",
        "slug" : "Inc_Control_Table",
        "x" : 220,
        "y" : 420,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ezD-AmWasBSI_-7gj8UZK$$DPIEehU-5MJa0w0Z-w9lB",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "yMppAXi9xDH68k4nd_qtq$$v3zoON491kVHSbuK6EYmz",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "ezD-AmWasBSI_-7gj8UZK$$DPIEehU-5MJa0w0Z-w9lB##full_load", "ezD-AmWasBSI_-7gj8UZK$$DPIEehU-5MJa0w0Z-w9lB##keys_file" ],
        "condition" : {
          "format" : "sql",
          "expression" : "keys_file = 0 and full_load = 0"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "tvAjagAIEmo1bdPNzoNhA$$dUx2ZnCRv0r2VktLAeOti" : {
      "id" : "tvAjagAIEmo1bdPNzoNhA$$dUx2ZnCRv0r2VktLAeOti",
      "component" : "Filter",
      "metadata" : {
        "label" : "Full_Control_Table",
        "slug" : "Full_Control_Table",
        "x" : 220,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "dataPreview" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "A6qNF3lh3lnTWvTps9GyY$$zl1mYa8Y1KjUuZw6_uZLc",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "ko6oIQJj9A3j3psEoIObT$$ktj2lAD0I5CaPTPVwuqQj",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "A6qNF3lh3lnTWvTps9GyY$$zl1mYa8Y1KjUuZw6_uZLc##inc_load", "A6qNF3lh3lnTWvTps9GyY$$zl1mYa8Y1KjUuZw6_uZLc##full_load" ],
        "condition" : {
          "format" : "sql",
          "expression" : "inc_load = 0 and full_load = 1"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "4LzTbrWQMrDIhFm6GoQjt$$in1HqEgVQvoYNcwiPiwcg" : {
      "id" : "4LzTbrWQMrDIhFm6GoQjt$$in1HqEgVQvoYNcwiPiwcg",
      "component" : "TableIterator",
      "metadata" : {
        "label" : "Keys_Load_for_Inc",
        "slug" : "Keys_Load_for_Inc",
        "x" : 420,
        "y" : 20,
        "phase" : 2,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "Config.var_full_load_mode_sfic_tao  == \"0\"",
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Kp4wBtPNrxsQNwYr4vknT$$D7ZOGo-mCnRF80t65em2g",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "metagemProperty" : {
          "availableColumnNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm" ],
          "availableConfigFieldNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm", "var_raw_container", "var_raw_storage_account", "var_copper_container", "var_delta_storage_account", "var_catalog_name", "var_etl_schema", "var_copper_schema", "var_bus_dt", "var_log_container", "var_warning_type", "var_info_type", "var_error_type", "var_file_check", "var_bus_dt_dt", "var_wkf_name", "var_task_name", "var_task_run_id", "var_wkf_run_id", "var_start_timestamp", "var_src_tao_sfic", "var_src_tao_snow", "var_src_tao_8fold", "var_matching_files", "var_aux_insert_datetime", "var_aux_updated_datetime", "var_aux_extract_bus_date", "var_aux_updated_extract_bus_date", "var_extract_bus_dt_tao_sfic", "var_log_type_generic", "var_log_schema", "var_full_load_mode_sfic_tao", "var_critical_file", "var_row_count" ],
          "numberOfThreads" : "5",
          "maxIteration" : "1000",
          "parallelismEnabled" : false,
          "configToColumnMap" : [ {
            "configName" : "bronze_table",
            "columnName" : "bronze_table"
          }, {
            "configName" : "raw_file_path",
            "columnName" : "raw_file_path"
          }, {
            "configName" : "file_prefix",
            "columnName" : "file_prefix"
          }, {
            "configName" : "file_type",
            "columnName" : "file_type"
          }, {
            "configName" : "encryption_type",
            "columnName" : "encryption_type"
          }, {
            "configName" : "field_separator",
            "columnName" : "field_separator"
          }, {
            "configName" : "part_file",
            "columnName" : "part_file"
          }, {
            "configName" : "keys_file",
            "columnName" : "keys_file"
          }, {
            "configName" : "headers_in_file",
            "columnName" : "headers_in_file"
          }, {
            "configName" : "full_load",
            "columnName" : "full_load"
          }, {
            "configName" : "inc_load",
            "columnName" : "inc_load"
          }, {
            "configName" : "critical",
            "columnName" : "critical"
          }, {
            "configName" : "business_keys",
            "columnName" : "business_keys"
          }, {
            "configName" : "tie_breaker_column",
            "columnName" : "tie_breaker_column"
          }, {
            "configName" : "enabled",
            "columnName" : "enabled"
          }, {
            "configName" : "ins_dtm",
            "columnName" : "ins_dtm"
          } ]
        }
      },
      "connections" : [ {
        "id" : "g2BG5-LwdYLIeDynqalU4",
        "source" : "4LzTbrWQMrDIhFm6GoQjt$$in1HqEgVQvoYNcwiPiwcg",
        "sourcePort" : "Kp4wBtPNrxsQNwYr4vknT$$D7ZOGo-mCnRF80t65em2g",
        "target" : "nslDSHRsJNITzTFFQtTXV$$Iq-w31RijK9EyGhwVv_y2",
        "targetPort" : "40EDoM4B-3r2i8OWXI2lE$$5dm0qsLmb9rJpXE30m_kZ",
        "visualProperty" : {
          "isHidden" : true
        }
      }, {
        "id" : "L9-MEusByU5pK0l-NL6r_",
        "source" : "rH1uaraBTJ8GSVDmbsR1_$$CV6YfaUSMYgus2wQq7Sfr",
        "sourcePort" : "ZcimVeymr8QpaTr6hQFk_$$9hZRxpvuvkbP1X_B1A7I_",
        "target" : "VHw4MWIiJUi6IPNycbO-W$$BmHN80hoTzCeEII4mDrKi",
        "targetPort" : "5RWXpJ-JMDj0KITavNsXk$$cacku-GQ-lOlZd11nGwip"
      }, {
        "id" : "MNkvFOGBXikDK3mxssoAb",
        "source" : "VHw4MWIiJUi6IPNycbO-W$$BmHN80hoTzCeEII4mDrKi",
        "sourcePort" : "A6sXI9BR31EgHwApBi-KR$$HkZgOOPI7qB1VmssF43UB",
        "target" : "tw8DEeHqM4MeL7IgWFmCq$$RSuEOnLeA4zJbt03-_HWB",
        "targetPort" : "C6cz0N6TL-5_JhE2mSsfU$$sm0lns4WzzofJnIQIogcv"
      }, {
        "id" : "4FlanE_y0reKCtZ9LBnHi",
        "source" : "M7Z2bXxzXn9o7pt-qsYUb$$fpd-fMVRcyhC2EioR_Xmm",
        "sourcePort" : "ptqt_pzgdDykK9Oz-Z7gn$$jqMaeA9Iuq-Sz_mLl3yOT",
        "target" : "rH1uaraBTJ8GSVDmbsR1_$$CV6YfaUSMYgus2wQq7Sfr",
        "targetPort" : "xwEOzp87W_VQCHoOPUNGX$$fQx4ZBFFFbfWXSPTptD5s"
      } ],
      "processes" : {
        "M7Z2bXxzXn9o7pt-qsYUb$$fpd-fMVRcyhC2EioR_Xmm" : {
          "id" : "M7Z2bXxzXn9o7pt-qsYUb$$fpd-fMVRcyhC2EioR_Xmm",
          "component" : "Directory",
          "metadata" : {
            "label" : "Keys_Directory_Listing",
            "slug" : "Keys_Directory_Listing",
            "x" : 660,
            "y" : 260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "ptqt_pzgdDykK9Oz-Z7gn$$jqMaeA9Iuq-Sz_mLl3yOT",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "path" : "abfss://${var_raw_container}@${var_raw_storage_account}.dfs.core.windows.net${raw_file_path}",
            "includeSubDirs" : false,
            "filePattern" : "*.*"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Directory",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "nslDSHRsJNITzTFFQtTXV$$Iq-w31RijK9EyGhwVv_y2" : {
          "id" : "nslDSHRsJNITzTFFQtTXV$$Iq-w31RijK9EyGhwVv_y2",
          "component" : "ControlFlowInput",
          "metadata" : {
            "label" : "TableIterator_Input_1_1_1",
            "slug" : "TableIterator_Input_1_1_1",
            "x" : 646.3998901367187,
            "y" : -62.37500610351569,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ {
              "id" : "40EDoM4B-3r2i8OWXI2lE$$5dm0qsLmb9rJpXE30m_kZ",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "bronze_table",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the initial storage table for raw data.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "raw_file_path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "File path where the raw data is stored.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_prefix",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Prefix used in naming the raw data files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Format of the raw data files, such as CSV or JSON.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encryption_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Method used to encrypt the raw data files for security.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "field_separator",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Character used to separate fields in the dataset files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "part_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file is a part of a larger file set.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "keys_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file contains key information for processing.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "headers_in_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates whether the file includes headers.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "full_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is a full load.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "inc_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "critical",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicator of the dataset's importance or priority level.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "business_keys",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifiers used to distinguish records in the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tie_breaker_column",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enabled",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is currently active or operational.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ins_dtm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 1,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowInput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "VHw4MWIiJUi6IPNycbO-W$$BmHN80hoTzCeEII4mDrKi" : {
          "id" : "VHw4MWIiJUi6IPNycbO-W$$BmHN80hoTzCeEII4mDrKi",
          "component" : "Script",
          "metadata" : {
            "label" : "Keys_Read_Deduplicate_Write_Delta",
            "slug" : "Keys_Read_Deduplicate_Write_Delta",
            "x" : 1060,
            "y" : 260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "5RWXpJ-JMDj0KITavNsXk$$cacku-GQ-lOlZd11nGwip",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "A6sXI9BR31EgHwApBi-KR$$HkZgOOPI7qB1VmssF43UB",
              "slug" : "copper_raw_dataframe",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false,
              "dataExplorerProps" : {
                "filter" : {
                  "type" : "Composite",
                  "op" : {
                    "type" : "AND"
                  },
                  "filters" : [ ]
                },
                "sorts" : [ ]
              }
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from datetime import datetime\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n\r\nglob_filter = f\"*{Config.file_type}\"\r\n\r\n# Remove the '.' from '.csv'\r\nclean_file_type = Config.file_type.replace(\".\", \"\")  # \".csv\" -> \"csv\"\r\n\r\n# Single f-string (avoid multiple adjacent f-strings that parser may flag)\r\n# If parser still errors, collapse to:\r\nraw_file_directory_path = f\"abfss://{Config.var_raw_container}@{Config.var_raw_storage_account}.dfs.core.windows.net{Config.raw_file_path}\"\r\n\r\nif Config.var_matching_files:\r\n    csv_opts = {\r\n    \"header\": \"true\",\r\n    \"multiLine\": \"true\",\r\n    \"sep\": f\"{Config.field_separator}\",\r\n    \"pathGlobFilter\": glob_filter,\r\n    \"escape\": '\"'\r\n}\r\n    copper_dataframe = tao_safe_read(\r\n        raw_file_directory_path,\r\n        clean_file_type,\r\n        description=f\"Read raw files for {Config.bronze_table}\",\r\n        copper_table=Config.bronze_table,\r\n        options=csv_opts,\r\n        severity=Config.var_error_type,\r\n        log_type=Config.var_log_type_generic\r\n    )\r\nelse:\r\n    copper_dataframe = None\r\n\r\nprint(copper_dataframe)\r\n\r\ndate_obj = datetime.strptime(Config.var_extract_bus_dt_tao_sfic, '%Y%m%d').date()\r\n\r\ntry:\r\n        \r\n    # check if there are duplicates\r\n    log_message = f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #)\r\n    partition_columns_list = [col(c.strip()) for c in Config.business_keys.split(\",\")]\r\n    window_spec = Window.partitionBy(*partition_columns_list).orderBy(lit(1))\r\n    \r\n    copper_dataframe_ranked = copper_dataframe.withColumn(\"row_number\", row_number().over(window_spec))\r\n    keys_dataframe = copper_dataframe_ranked.filter(copper_dataframe_ranked[\"row_number\"] == 1).drop(\"row_number\")\r\n\r\n    return keys_dataframe\r\nexcept Exception as e:\r\n    \r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message =  \"Error during transform->\"+ log_message+ str(e)\r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    raise    \r\n",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return copper_raw_dataframe"
          }
        },
        "tw8DEeHqM4MeL7IgWFmCq$$RSuEOnLeA4zJbt03-_HWB" : {
          "id" : "tw8DEeHqM4MeL7IgWFmCq$$RSuEOnLeA4zJbt03-_HWB",
          "component" : "Script",
          "metadata" : {
            "label" : "Keys_Incremental_load_operations",
            "slug" : "Keys_Incremental_load_operations",
            "x" : 1300,
            "y" : 240,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "C6cz0N6TL-5_JhE2mSsfU$$sm0lns4WzzofJnIQIogcv",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from delta.tables import DeltaTable\r\n\r\ntry:\r\n    # split the business keys into a list\r\n    copper_table = f\"{Config.var_catalog_name}.{Config.var_copper_schema}.{Config.bronze_table}\"\r\n    copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_schema}.copper_load_log\"\r\n    keys = Config.business_keys.split(\",\")\r\n\r\n    # create the merge keys condition for the merge operation\r\n    mergekeys = \"\"\r\n    for key in keys:\r\n        escaped_key = key.replace('\"', '\\\\\"')\r\n        # one table will be aliased as 'existing', the other as 'new'\r\n        mergekeys = (\r\n            mergekeys + \"existing.`\" + escaped_key + \"` = \" + \"keys.`\" + escaped_key + \"` and \"\r\n        )\r\n    # remove the extra 'and '\r\n    mergekeys = mergekeys[:-4]\r\n    \r\n    delta_table = DeltaTable.forName(spark, copper_table)\r\n\r\n    delta_table_df = delta_table.toDF()\r\n\r\n    log_message = f\"Delete rows from {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n    keys_dataframe = in0.drop(\"row_number\")\r\n    merge_result = (\r\n        delta_table.alias(\"existing\")\r\n            .merge(keys_dataframe.alias(\"keys\"), mergekeys)\r\n            .whenNotMatchedBySourceDelete().execute()\r\n    )\r\n\r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_log_type_generic,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n    )\r\n    \r\n    # Get the latest operation\r\n    log_message = f\"Gather Operational Metrics for {Config.bronze_table} delete: \"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n    \r\n    history = delta_table.history() \r\n    latest_operation = history.orderBy(\"timestamp\", ascending=False).first()\r\n\r\n    if latest_operation and latest_operation[\"operation\"] == \"MERGE\":\r\n        operation_metrics = latest_operation[\"operationMetrics\"]\r\n        num_deleted = int(operation_metrics.get(\"numTargetRowsDeleted\", 0))\r\n        \r\n        log_message = f\"Number of rows deleted: {num_deleted} \"\r\n        #log_message = (\r\n        #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n        #    f\"{message}\"\r\n        #)\r\n        \r\n        tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            num_deleted,\r\n            None,\r\n            None\r\n        )\r\n\r\n    else:\r\n        log_message = f\"Couldn't retrieve metrics of the DELETE operation\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n\r\nexcept Exception as e:\r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message = \"Error during transform->\"+ log_message+ str(e)\r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_log_type_generic,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    raise",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "rH1uaraBTJ8GSVDmbsR1_$$CV6YfaUSMYgus2wQq7Sfr" : {
          "id" : "rH1uaraBTJ8GSVDmbsR1_$$CV6YfaUSMYgus2wQq7Sfr",
          "component" : "Script",
          "metadata" : {
            "label" : "Keys_Defensive_checks_UDF",
            "slug" : "Keys_Defensive_checks_UDF",
            "x" : 860,
            "y" : 260,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "xwEOzp87W_VQCHoOPUNGX$$fQx4ZBFFFbfWXSPTptD5s",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "size",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "creation_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "modification_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parent_directory",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ZcimVeymr8QpaTr6hQFk_$$9hZRxpvuvkbP1X_B1A7I_",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nimport fnmatch\r\n\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nfile_prefix = f\"{Config.file_prefix}\" + \"*\" + f\"{Config.file_type}\"\r\n\r\nreturn_df_row=[]\r\n\r\nif in0.isEmpty():\r\n    log_message = (\r\n        f\"The directory abfss://{Config.var_raw_container}@\"\r\n        f\"{Config.var_raw_storage_account}{Config.raw_file_path} is empty\"\r\n    )\r\n    tao_custom_logger(\r\n        Config.var_error_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    Config.var_matching_files = False\r\n    #return_df_row = [(0,)]\r\n    #return_df = spark.createDataFrame(return_df_row, [\"return_df_row\"])\r\n    #return return_df\r\nelse:\r\n    log_message = \"Files found in the directory:\\n\"\r\n    for row in in0.collect():\r\n        size_in_mb = f\"{row.size / (1024 * 1024):.2f} MB\"\r\n        log_message += (\r\n            f\"Path={row.path}, Name={row.name}, Size={size_in_mb}, \"\r\n            f\"ModificationTime={row.modification_time}\\n\"\r\n        )\r\n    tao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    file_names = [row.name for row in in0.select(\"name\").collect()]\r\n    nr_files = len(file_names)\r\n    matching_files = fnmatch.filter(file_names, file_prefix)\r\n    nr_matching_files = len(matching_files)\r\n    if matching_files:\r\n            log_message = f\"Files matching the pattern are {matching_files}. Number of matching files: {nr_matching_files}, out of a total of {nr_files} files\"\r\n            tao_custom_logger(\r\n                Config.var_info_type,\r\n                Config.var_file_check,\r\n                log_message,\r\n                Config.bronze_table,\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            Config.var_matching_files = True\r\n\r\n    else:\r\n        log_message = f\"No files matching the pattern were found. List of files found: {file_names}\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n        Config.var_matching_files = False\r\n\r\n\r\nreturn_df_row=[(0)]\r\nreturn_df = spark.createDataFrame(return_df_row,[\"return_df_row\"])\r\nreturn return_df",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return out0"
          }
        },
        "XZZdhV3ZgUpxbKZTD11Ov$$HvUmUCp6oTeXUG3qJKmw2" : {
          "id" : "XZZdhV3ZgUpxbKZTD11Ov$$HvUmUCp6oTeXUG3qJKmw2",
          "component" : "ControlFlowOutput",
          "metadata" : {
            "label" : "TableIterator_Output_1_1_1",
            "slug" : "TableIterator_Output_1_1_1",
            "x" : 646.3998901367187,
            "y" : -62.37500610351569,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 0,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowOutput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/TableIterator",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "1usNRQ4J9VWFYir1FBng-$$ilfhRBrfVU-b6156F6UqC" : {
      "id" : "1usNRQ4J9VWFYir1FBng-$$ilfhRBrfVU-b6156F6UqC",
      "component" : "TableIterator",
      "metadata" : {
        "label" : "Inc_Load_for_Inc",
        "slug" : "Inc_Load_for_Inc",
        "x" : 420,
        "y" : 420,
        "phase" : 1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "Config.var_full_load_mode_sfic_tao  == \"0\"",
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "bxI1fWaP5LLPEW6Gdbkdw$$2HlXXfCUpdS4SRHgX-2PJ",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "metagemProperty" : {
          "availableColumnNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm" ],
          "availableConfigFieldNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm", "var_raw_container", "var_raw_storage_account", "var_copper_container", "var_delta_storage_account", "var_catalog_name", "var_etl_schema", "var_copper_schema", "var_bus_dt", "var_log_container", "var_warning_type", "var_info_type", "var_error_type", "var_file_check", "var_bus_dt_dt", "var_wkf_name", "var_task_name", "var_task_run_id", "var_wkf_run_id", "var_start_timestamp", "var_src_tao_sfic", "var_src_tao_snow", "var_src_tao_8fold", "var_matching_files", "var_aux_insert_datetime", "var_aux_updated_datetime", "var_aux_extract_bus_date", "var_aux_updated_extract_bus_date", "var_extract_bus_dt_tao_sfic", "var_log_type_generic", "var_log_schema", "var_full_load_mode_sfic_tao", "var_critical_file", "var_row_count" ],
          "numberOfThreads" : "5",
          "maxIteration" : "1000",
          "parallelismEnabled" : false,
          "configToColumnMap" : [ {
            "configName" : "bronze_table",
            "columnName" : "bronze_table"
          }, {
            "configName" : "raw_file_path",
            "columnName" : "raw_file_path"
          }, {
            "configName" : "file_prefix",
            "columnName" : "file_prefix"
          }, {
            "configName" : "file_type",
            "columnName" : "file_type"
          }, {
            "configName" : "encryption_type",
            "columnName" : "encryption_type"
          }, {
            "configName" : "field_separator",
            "columnName" : "field_separator"
          }, {
            "configName" : "part_file",
            "columnName" : "part_file"
          }, {
            "configName" : "keys_file",
            "columnName" : "keys_file"
          }, {
            "configName" : "headers_in_file",
            "columnName" : "headers_in_file"
          }, {
            "configName" : "full_load",
            "columnName" : "full_load"
          }, {
            "configName" : "inc_load",
            "columnName" : "inc_load"
          }, {
            "configName" : "critical",
            "columnName" : "critical"
          }, {
            "configName" : "business_keys",
            "columnName" : "business_keys"
          }, {
            "configName" : "tie_breaker_column",
            "columnName" : "tie_breaker_column"
          }, {
            "configName" : "enabled",
            "columnName" : "enabled"
          }, {
            "configName" : "ins_dtm",
            "columnName" : "ins_dtm"
          } ]
        }
      },
      "connections" : [ {
        "id" : "jgfA-EJag-hmNwnRLDWbq",
        "source" : "1usNRQ4J9VWFYir1FBng-$$ilfhRBrfVU-b6156F6UqC",
        "sourcePort" : "bxI1fWaP5LLPEW6Gdbkdw$$2HlXXfCUpdS4SRHgX-2PJ",
        "target" : "dtzb0sRoutYMY9Rd2vQRC$$MtOkgnxHG1Q3sCYE1z4pR",
        "targetPort" : "bMixJiE8gVbpThkHYjTu1$$hHig2Umlxf23Ni2B6op_k",
        "visualProperty" : {
          "isHidden" : true
        }
      }, {
        "id" : "nvvnN9dZ317BNabvmMXlp",
        "source" : "7KxUaDALKN4-ah5d_fOFE$$kp3G2JxeHx3enDVYlLDLa",
        "sourcePort" : "Iw4zW4Ee-gwk8crcjclmb$$5PXuRfiN5KO6C_TDqBQxm",
        "target" : "nxY76np3jjeSZyjihaCj_$$N3cwg91BQhe8BaOUgwgOc",
        "targetPort" : "2uG3nA1Qy0iRPLp1ewOU3$$XadPWp-M-Ff8ZKD4IfVNV"
      }, {
        "id" : "FsRg89L526YQE8BGeBx27",
        "source" : "nxY76np3jjeSZyjihaCj_$$N3cwg91BQhe8BaOUgwgOc",
        "sourcePort" : "0xAQTOfL2PHHz-HaLRRlV$$UfGJ4IePvSnOb8p-ApPik",
        "target" : "jgjitSYuRMDDhagOSxqpg$$0rFam0KHioXPguRCOoRnd",
        "targetPort" : "ssSZgbri9h8yq1SBYWpxQ$$-dcAQ_2NpoBDK6Xr8ZWOn"
      }, {
        "id" : "0Nk-Rmr5UwmW21Z1PmNe7",
        "source" : "jgjitSYuRMDDhagOSxqpg$$0rFam0KHioXPguRCOoRnd",
        "sourcePort" : "Sxo8AzpeezAeZH5qnqpZ8$$WgJQcRO-gaewFosOWOcRZ",
        "target" : "2tt4cnzsoideUcKQ1SFJT$$BGCl_Dgv14y91SvB8VhuB",
        "targetPort" : "i6SNGvKdCSkA81p4PPQd5$$CXWQ1KnKlcOix_NJIkYQW"
      }, {
        "id" : "UdFxAKNysVVSg9Wdjow4t",
        "source" : "jgjitSYuRMDDhagOSxqpg$$0rFam0KHioXPguRCOoRnd",
        "sourcePort" : "xiE6jA3Ruh2kyJTYCYcNw$$Qu3DILlsMpgBtICOFhP6w",
        "target" : "Vi9LLfMxsEZfE4RrkfA3X$$QzyYa7UDp8Lj9tyEkrah6",
        "targetPort" : "hoeQ_gFWgwI8xFr-eDKst$$mLVrOLIKbhO5lwS1DgptU"
      }, {
        "id" : "afU1LU5wxd2sa1VIahIMz",
        "source" : "c-7stiaZGUaD1xHmBLQMd$$jVVLCi9IYeD6Ye84FduJ8",
        "sourcePort" : "dSLB6e3swlurL_wlzbGKP$$7X9qhGQkBTNdR3ar0f-XE",
        "target" : "7KxUaDALKN4-ah5d_fOFE$$kp3G2JxeHx3enDVYlLDLa",
        "targetPort" : "CclMf0PXmtn_H41Fb-TSr$$Tr-8iGmdIXek_3aom1f9v"
      } ],
      "processes" : {
        "Vi9LLfMxsEZfE4RrkfA3X$$QzyYa7UDp8Lj9tyEkrah6" : {
          "id" : "Vi9LLfMxsEZfE4RrkfA3X$$QzyYa7UDp8Lj9tyEkrah6",
          "component" : "Script",
          "metadata" : {
            "label" : "Incremental_load_operations",
            "slug" : "Incremental_load_operations",
            "x" : 1400,
            "y" : 60,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "hoeQ_gFWgwI8xFr-eDKst$$mLVrOLIKbhO5lwS1DgptU",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from delta.tables import DeltaTable\r\n\r\ntry:\r\n    # split the business keys into a list\r\n    copper_table = f\"{Config.var_catalog_name}.{Config.var_copper_schema}.{Config.bronze_table}\"\r\n    copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_schema}.copper_load_log\"\r\n    keys = Config.business_keys.split(\",\")\r\n\r\n    # create the merge keys condition for the merge operation\r\n    mergekeys = \"\"\r\n    for key in keys:\r\n        escaped_key = key.replace('\"', '\\\\\"')\r\n        # one table will be aliased as 'existing', the other as 'new'\r\n        mergekeys = (\r\n            mergekeys + \"existing.`\" + escaped_key + \"` = \" + \"new.`\" + escaped_key + \"` and \"\r\n        )\r\n    # remove the extra 'and '\r\n    mergekeys = mergekeys[:-4]\r\n    \r\n    delta_table = DeltaTable.forName(spark, copper_table)\r\n    delta_table_df = delta_table.toDF()\r\n\r\n    # create the set of columns for the insert part of the merge operation\r\n    # this needs to be done since we won't be inserting into all columns of the existing delta table\r\n    # thus we can't use the WhenNotMatchedInsertAll method\r\n    insert_columns_set = \"\"\r\n    # we exclude the last columns of the delta table since those are the aux columns manually created\r\n    for df_col in delta_table_df.columns[:-4]:\r\n        escaped_col = df_col.replace('\"', '\\\\\"')\r\n        insert_columns_set = (\r\n            insert_columns_set + '\"existing.`' + escaped_col + '`\": \"new.`' + escaped_col + '`\",'\r\n        )\r\n\r\n    update_columns_set = insert_columns_set\r\n    current_time = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\r\n\r\n    # When inserting  new records we need the current time for the aux_ins_dtm field and the var_extract_bus_date_sfic for the aux_extract_bus_date\r\n    insert_columns_set = (\r\n        insert_columns_set\r\n        + '\"existing.'\r\n        + Config.var_aux_insert_datetime\r\n        + '\": \"\\''\r\n        + f\"{current_time}\"\r\n        + '\\'\", \"existing.'\r\n        + Config.var_aux_extract_bus_date\r\n        + '\": \"\\''\r\n        + f\"Config.var_extract_bus_dt_tao_sfic\"\r\n        + \"'\\\"\"\r\n    )\r\n    insert_columns_set = \"{\" + f\"{insert_columns_set}\" + \"}\"\r\n\r\n    # When updating we need the current time for the aux_upd_dtm field and the var_extract_bus_date_sfic for the aux_upd_extract_bus_date\r\n    update_columns_set = (\r\n        update_columns_set\r\n        + '\"existing.'\r\n        + Config.var_aux_updated_datetime\r\n        + '\": \"\\''\r\n        + f\"{current_time}\"\r\n        + '\\'\", \"existing.'\r\n        + Config.var_aux_updated_extract_bus_date\r\n        + '\": \"\\''\r\n        + f\"Config.var_extract_bus_dt_tao_sfic\"\r\n        + \"'\\\"\"\r\n    )\r\n    update_columns_set = \"{\" + f\"{update_columns_set}\" + \"}\"\r\n\r\n    # the merge operation requires dictionary objects to be passed\r\n    insert_dict = json.loads(insert_columns_set)\r\n    update_dict = json.loads(update_columns_set)\r\n\r\n    log_message = f\"Merge into {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n    copper_dataframe = in0.drop(\"row_number\")\r\n    merge_result = (\r\n        delta_table.alias(\"existing\")\r\n            .merge(copper_dataframe.alias(\"new\"), mergekeys)\r\n            .whenMatchedUpdate(set=update_dict)\r\n            .whenNotMatchedInsert(values=insert_dict)\r\n            .execute()\r\n    )\r\n\r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_log_type_generic,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n    )\r\n    \r\n    # Get the latest operation\r\n    log_message = f\"Gather Operational Metrics for {Config.bronze_table} Merge: \"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n    \r\n    history = delta_table.history() \r\n    latest_operation = history.orderBy(\"timestamp\", ascending=False).first()\r\n\r\n    if latest_operation and latest_operation[\"operation\"] == \"MERGE\":\r\n        operation_metrics = latest_operation[\"operationMetrics\"]\r\n        num_inserted = int(operation_metrics.get(\"numTargetRowsInserted\", 0))\r\n        num_updated = int(operation_metrics.get(\"numTargetRowsUpdated\", 0))\r\n\r\n        log_message = f\"Number of rows inserted: {num_inserted} and Number of rows updated: {num_updated}\"\r\n        #log_message = (\r\n        #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n        #    f\"{message}\"\r\n        #)\r\n        \r\n        tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            num_inserted,\r\n            num_updated,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n\r\n    else:\r\n        log_message = f\"Couldn't retrieve metrics of the merge operation\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n\r\nexcept Exception as e:\r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message =  \"Error during transform->\"+ log_message+ str(e)\r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_log_type_generic,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    raise",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "7KxUaDALKN4-ah5d_fOFE$$kp3G2JxeHx3enDVYlLDLa" : {
          "id" : "7KxUaDALKN4-ah5d_fOFE$$kp3G2JxeHx3enDVYlLDLa",
          "component" : "Script",
          "metadata" : {
            "label" : "Inc_Defensive_checks_UDF",
            "slug" : "Inc_Defensive_checks_UDF",
            "x" : 600,
            "y" : 360,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "CclMf0PXmtn_H41Fb-TSr$$Tr-8iGmdIXek_3aom1f9v",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "size",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "creation_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "modification_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parent_directory",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Iw4zW4Ee-gwk8crcjclmb$$5PXuRfiN5KO6C_TDqBQxm",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nimport fnmatch\r\n\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nfile_prefix = f\"{Config.file_prefix}\" + \"*\" + f\"{Config.file_type}\"\r\n\r\nreturn_df_row=[]\r\n\r\nif in0.isEmpty():\r\n    log_message = (\r\n        f\"The directory abfss://{Config.var_raw_container}@\"\r\n        f\"{Config.var_raw_storage_account}{Config.raw_file_path} is empty\"\r\n    )\r\n    tao_custom_logger(\r\n        Config.var_error_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    Config.var_matching_files = False\r\n\r\nelse:\r\n    log_message = \"Files found in the directory:\\n\"\r\n    for row in in0.collect():\r\n        size_in_mb = f\"{row.size / (1024 * 1024):.2f} MB\"\r\n        log_message += (\r\n            f\"Path={row.path}, Name={row.name}, Size={size_in_mb}, \"\r\n            f\"ModificationTime={row.modification_time}\\n\"\r\n        )\r\n    tao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    file_names = [row.name for row in in0.select(\"name\").collect()]\r\n    nr_files = len(file_names)\r\n    matching_files = fnmatch.filter(file_names, file_prefix)\r\n    nr_matching_files = len(matching_files)\r\n    if matching_files:\r\n            log_message = f\"Files matching the pattern are {matching_files}. Number of matching files: {nr_matching_files}, out of a total of {nr_files} files\"\r\n            tao_custom_logger(\r\n                Config.var_info_type,\r\n                Config.var_file_check,\r\n                log_message,\r\n                Config.bronze_table,\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            Config.var_matching_files = True\r\n            #return_df_row=[(1)]\r\n            #return_df = spark.createDataFrame(return_df_row,[\"return_df_row\"])\r\n            #return return_df\r\n    else:\r\n        log_message = f\"No files matching the pattern were found. List of files found: {file_names}\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n        Config.var_matching_files = False\r\n\r\nreturn_df_row=[(0)]\r\nreturn_df = spark.createDataFrame(return_df_row,[\"return_df_row\"])\r\nreturn return_df",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return out0"
          }
        },
        "c-7stiaZGUaD1xHmBLQMd$$jVVLCi9IYeD6Ye84FduJ8" : {
          "id" : "c-7stiaZGUaD1xHmBLQMd$$jVVLCi9IYeD6Ye84FduJ8",
          "component" : "Directory",
          "metadata" : {
            "label" : "Inc_Directory_Listing",
            "slug" : "Inc_Directory_Listing",
            "x" : 400,
            "y" : 360,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "dSLB6e3swlurL_wlzbGKP$$7X9qhGQkBTNdR3ar0f-XE",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "path" : "abfss://${var_raw_container}@${var_raw_storage_account}.dfs.core.windows.net${raw_file_path}",
            "includeSubDirs" : true,
            "filePattern" : "*.*"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Directory",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "0RGhVM6qR5gNmPqUq6irk$$PXa-Rrld05C2F_Hdo5Z8Z" : {
          "id" : "0RGhVM6qR5gNmPqUq6irk$$PXa-Rrld05C2F_Hdo5Z8Z",
          "component" : "ControlFlowOutput",
          "metadata" : {
            "label" : "TableIterator_Output_1_1",
            "slug" : "TableIterator_Output_1_1",
            "x" : 389.1999267578125,
            "y" : 38.81666259765623,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 0,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowOutput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "jgjitSYuRMDDhagOSxqpg$$0rFam0KHioXPguRCOoRnd" : {
          "id" : "jgjitSYuRMDDhagOSxqpg$$0rFam0KHioXPguRCOoRnd",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "Inc_RowDistributor",
            "slug" : "Inc_RowDistributor",
            "x" : 1000,
            "y" : 360,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "ssSZgbri9h8yq1SBYWpxQ$$-dcAQ_2NpoBDK6Xr8ZWOn",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "xiE6jA3Ruh2kyJTYCYcNw$$Qu3DILlsMpgBtICOFhP6w",
              "slug" : "out0"
            }, {
              "id" : "Sxo8AzpeezAeZH5qnqpZ8$$WgJQcRO-gaewFosOWOcRZ",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "xiE6jA3Ruh2kyJTYCYcNw$$Qu3DILlsMpgBtICOFhP6w",
              "model" : {
                "format" : "sql",
                "expression" : "row_number=1"
              }
            }, {
              "path" : "out1",
              "id" : "Sxo8AzpeezAeZH5qnqpZ8$$WgJQcRO-gaewFosOWOcRZ",
              "model" : {
                "format" : "sql",
                "expression" : "row_number>1"
              }
            } ],
            "distributeUnmatchedRows" : null
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "nxY76np3jjeSZyjihaCj_$$N3cwg91BQhe8BaOUgwgOc" : {
          "id" : "nxY76np3jjeSZyjihaCj_$$N3cwg91BQhe8BaOUgwgOc",
          "component" : "Script",
          "metadata" : {
            "label" : "Inc_Read_Deduplicate_Write_Delta",
            "slug" : "Inc_Read_Deduplicate_Write_Delta",
            "x" : 800,
            "y" : 360,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "2uG3nA1Qy0iRPLp1ewOU3$$XadPWp-M-Ff8ZKD4IfVNV",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "0xAQTOfL2PHHz-HaLRRlV$$UfGJ4IePvSnOb8p-ApPik",
              "slug" : "copper_raw_dataframe",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false,
              "dataExplorerProps" : {
                "filter" : {
                  "type" : "Composite",
                  "op" : {
                    "type" : "AND"
                  },
                  "filters" : [ ]
                },
                "sorts" : [ ]
              }
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from datetime import datetime\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n\r\nglob_filter = f\"*{Config.file_type}\"\r\n\r\n# Remove the '.' from '.csv'\r\nclean_file_type = Config.file_type.replace(\".\", \"\")  # \".csv\" -> \"csv\"\r\n\r\n# Single f-string (avoid multiple adjacent f-strings that parser may flag)\r\n# If parser still errors, collapse to:\r\nraw_file_directory_path = f\"abfss://{Config.var_raw_container}@{Config.var_raw_storage_account}.dfs.core.windows.net{Config.raw_file_path}\"\r\n\r\nif Config.var_matching_files:\r\n    csv_opts = {\r\n    \"header\": \"true\",\r\n    \"multiLine\": \"true\",\r\n    \"sep\": f\"{Config.field_separator}\",\r\n    \"pathGlobFilter\": glob_filter,\r\n    \"escape\": '\"'\r\n}\r\n    copper_dataframe = tao_safe_read(\r\n        raw_file_directory_path,\r\n        clean_file_type,\r\n        description=f\"Read raw files for {Config.bronze_table}\",\r\n        copper_table=Config.bronze_table,\r\n        options=csv_opts,\r\n        severity=Config.var_error_type,\r\n        log_type=Config.var_log_type_generic\r\n    )\r\nelse:\r\n    copper_dataframe = None\r\n\r\ndate_obj = datetime.strptime(Config.var_extract_bus_dt_tao_sfic, '%Y%m%d').date()\r\ntry:\r\n    log_message = f\"Add metadata columns for {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"Add metadata columns for {Config.bronze_table}\"\r\n    #)\r\n    copper_dataframe = copper_dataframe.withColumn(Config.var_aux_insert_datetime, current_timestamp()) \\\r\n        .withColumn(Config.var_aux_updated_datetime, lit(None).cast(TimestampType())) \\\r\n        .withColumn(Config.var_aux_extract_bus_date, lit(str(date_obj)).cast(StringType())) \\\r\n        .withColumn(Config.var_aux_updated_extract_bus_date, lit(None).cast(StringType()))\r\n\r\n    \r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_log_type_generic,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    \r\n    # check if there are duplicates\r\n    log_message = f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #)\r\n    partition_columns_list = [col(c.strip()) for c in Config.business_keys.split(\",\")]\r\n    if Config.tie_breaker_column is None:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(lit(1))\r\n    else:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(copper_dataframe[Config.tie_breaker_column].desc())\r\n\r\n    copper_dataframe_ranked = copper_dataframe.withColumn(\"row_number\", row_number().over(window_spec))\r\n\r\n    return copper_dataframe_ranked\r\nexcept Exception as e:\r\n    \r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message = \"Error during transform->\"+ log_message+ str(e)\r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    raise    \r\n",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return copper_raw_dataframe"
          }
        },
        "2tt4cnzsoideUcKQ1SFJT$$BGCl_Dgv14y91SvB8VhuB" : {
          "id" : "2tt4cnzsoideUcKQ1SFJT$$BGCl_Dgv14y91SvB8VhuB",
          "component" : "Script",
          "metadata" : {
            "label" : "inc_Duplicate_Record_Logger",
            "slug" : "inc_Duplicate_Record_Logger",
            "x" : 1200,
            "y" : 460,
            "phase" : 2,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "i6SNGvKdCSkA81p4PPQd5$$CXWQ1KnKlcOix_NJIkYQW",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nfrom datetime import datetime\r\n\r\nerror_table = f\"{Config.var_catalog_name}.{Config.var_log_schema}.etl_error_log\"\r\nvar_timestp = f\"{Config.var_start_timestamp}\"\r\nif not in0.isEmpty():\r\n    ts_val = datetime.strptime(var_timestp, \"%Y-%m-%d %H:%M:%S\")\r\n    src_table_val = f\"{Config.file_prefix}{Config.file_type}\"\r\n    json_bad_dataframe = in0.select(\r\n                        lit(ts_val).alias(\"ins_tms\"),\r\n                        lit(f\"{Config.var_bus_dt}\").alias(\"bus_dt\"),\r\n                        lit(src_table_val).alias(\"src_table\"),\r\n                        lit(f\"{Config.bronze_table}\").alias(\"tgt_table\"),\r\n                        lit(\"Write duplicated records for \" f\"{Config.bronze_table}\").alias(\"error_message\"),\r\n                        lit(f\"{Config.var_copper_schema}\").alias(\"error_stage\"),\r\n                        to_json(struct(\"*\"), options={\"ignoreNullFields\": \"false\"}).alias(\"data_payload\"),\r\n                        lit(f\"{Config.var_wkf_name}\").alias(\"wkf_name\"),\r\n                        lit(f\"{Config.var_wkf_run_id}\").alias(\"wkf_run_id\"),\r\n                        lit(f\"{Config.var_task_name}\").alias(\"task_name\"),\r\n                        lit(f\"{Config.var_task_run_id}\").alias(\"task_run_id\")\r\n    ).write.format(\"delta\").mode(\"append\").saveAsTable(error_table)\r\n\r\n    copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n    log_message = f\"Write duplicate records for {Config.bronze_table}: {in0.count()} \"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n\r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            #in0.count(),\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            in0.count(),\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n    )\r\n",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "dtzb0sRoutYMY9Rd2vQRC$$MtOkgnxHG1Q3sCYE1z4pR" : {
          "id" : "dtzb0sRoutYMY9Rd2vQRC$$MtOkgnxHG1Q3sCYE1z4pR",
          "component" : "ControlFlowInput",
          "metadata" : {
            "label" : "TableIterator_Input_1_1",
            "slug" : "TableIterator_Input_1_1",
            "x" : 389.1999267578125,
            "y" : 38.81666259765623,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ {
              "id" : "bMixJiE8gVbpThkHYjTu1$$hHig2Umlxf23Ni2B6op_k",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "bronze_table",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the initial storage table for raw data.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "raw_file_path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "File path where the raw data is stored.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_prefix",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Prefix used in naming the raw data files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Format of the raw data files, such as CSV or JSON.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encryption_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Method used to encrypt the raw data files for security.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "field_separator",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Character used to separate fields in the dataset files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "part_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file is a part of a larger file set.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "keys_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file contains key information for processing.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "headers_in_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates whether the file includes headers.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "full_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is a full load.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "inc_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "critical",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicator of the dataset's importance or priority level.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "business_keys",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifiers used to distinguish records in the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tie_breaker_column",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enabled",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is currently active or operational.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ins_dtm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 1,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowInput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/TableIterator",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48" : {
      "id" : "IKQpepXBydZLOrBIpVabh$$bhy7WOT4K1JlZcn_L4M48",
      "component" : "Source",
      "metadata" : {
        "label" : "control_table_consolidated",
        "slug" : "control_table_consolidated",
        "x" : 20,
        "y" : 320,
        "phase" : 0,
        "cache" : true,
        "detailedStats" : false,
        "isImported" : false,
        "dataPreview" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "lYWc6ksfH0dDgmO4HRQav$$IXjBkK0Szh7jv9YJGpsE9",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/tao_sfic_control_table_inc"
      }
    },
    "8hr_tkGBtv5FwE0nVYih7$$KGCe8lxADUkdvzPqyA1l6" : {
      "id" : "8hr_tkGBtv5FwE0nVYih7$$KGCe8lxADUkdvzPqyA1l6",
      "component" : "TableIterator",
      "metadata" : {
        "label" : "Full_Load",
        "slug" : "Full_Load",
        "x" : 220,
        "y" : 620,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "Config.var_full_load_mode_sfic_tao  == \"1\"",
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "uhIMgKK8oUCuRzibzjjzA$$2rWUJmOkUdz6iuKc7mbsX",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "metagemProperty" : {
          "availableColumnNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm" ],
          "availableConfigFieldNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm", "var_raw_container", "var_raw_storage_account", "var_copper_container", "var_delta_storage_account", "var_catalog_name", "var_etl_schema", "var_copper_schema", "var_bus_dt", "var_log_container", "var_warning_type", "var_info_type", "var_error_type", "var_file_check", "var_bus_dt_dt", "var_wkf_name", "var_task_name", "var_task_run_id", "var_wkf_run_id", "var_start_timestamp", "var_src_tao_sfic", "var_src_tao_snow", "var_src_tao_8fold", "var_matching_files", "var_aux_insert_datetime", "var_aux_updated_datetime", "var_aux_extract_bus_date", "var_aux_updated_extract_bus_date", "var_extract_bus_dt_tao_sfic", "var_log_type_generic", "var_log_schema", "var_critical_file", "var_row_count", "var_full_load_mode_sfic_tao" ],
          "numberOfThreads" : "4",
          "maxIteration" : "1000",
          "parallelismEnabled" : false,
          "configToColumnMap" : [ {
            "configName" : "bronze_table",
            "columnName" : "bronze_table"
          }, {
            "configName" : "raw_file_path",
            "columnName" : "raw_file_path"
          }, {
            "configName" : "file_prefix",
            "columnName" : "file_prefix"
          }, {
            "configName" : "file_type",
            "columnName" : "file_type"
          }, {
            "configName" : "encryption_type",
            "columnName" : "encryption_type"
          }, {
            "configName" : "field_separator",
            "columnName" : "field_separator"
          }, {
            "configName" : "part_file",
            "columnName" : "part_file"
          }, {
            "configName" : "keys_file",
            "columnName" : "keys_file"
          }, {
            "configName" : "headers_in_file",
            "columnName" : "headers_in_file"
          }, {
            "configName" : "full_load",
            "columnName" : "full_load"
          }, {
            "configName" : "inc_load",
            "columnName" : "inc_load"
          }, {
            "configName" : "critical",
            "columnName" : "critical"
          }, {
            "configName" : "business_keys",
            "columnName" : "business_keys"
          }, {
            "configName" : "tie_breaker_column",
            "columnName" : "tie_breaker_column"
          }, {
            "configName" : "enabled",
            "columnName" : "enabled"
          }, {
            "configName" : "ins_dtm",
            "columnName" : "ins_dtm"
          } ]
        }
      },
      "connections" : [ {
        "id" : "-32vs2379OFNc0WJHRKfD",
        "source" : "8hr_tkGBtv5FwE0nVYih7$$KGCe8lxADUkdvzPqyA1l6",
        "sourcePort" : "uhIMgKK8oUCuRzibzjjzA$$2rWUJmOkUdz6iuKc7mbsX",
        "target" : "sT8wc7gAzgF8OxaLz65O7$$uyPsfPVjHzJgHFjjiSIgd",
        "targetPort" : "341lAGp1exTo7CLvHdBfr$$xTgEczadt_Uv-cXbTIh-u",
        "visualProperty" : {
          "isHidden" : true
        }
      }, {
        "id" : "wKEG0G6NUKJDYQpiKI8aT",
        "source" : "_iklIP4He6ORS15dW1P8F$$9I36ngxrOj4GoOGLgUE8A",
        "sourcePort" : "fUQvKLVFplxz3m0eoRLgf$$kW7SxGwnoQZeIQoY3d-wE",
        "target" : "hmaPn0L5Tb-hACLWWvZ8N$$ELfGV_GpBwpdVJZ-Yt5_U",
        "targetPort" : "GU9GM2lodTVLaqRx_zeDB$$q7KLy1Remb3p76zAtSfdY"
      }, {
        "id" : "_mQWiSE46YG3_yHKk4cvk",
        "source" : "0W_TQMu339RTml913qSyn$$PzmmEW6OXmoExxCslfyVv",
        "sourcePort" : "yMyVowaU-OQMn8h0P8MIU$$oqtt_kixmOA-V97X1Y8Jr",
        "target" : "EQU4Ir3ryehzsVSS6hUJ8$$w2o7GEJsF0XAdbwN9rkwn",
        "targetPort" : "Yld8q34WQ5aKdDjxRY1HK$$PJ7L0Lrct_reID1vABnWU"
      }, {
        "id" : "1jR5tgrudJ3WEaF8gd0i4",
        "source" : "EQU4Ir3ryehzsVSS6hUJ8$$w2o7GEJsF0XAdbwN9rkwn",
        "sourcePort" : "gEyDIgOkP6NHILoT1Uocv$$nUib_T9orO2dgFOXHMagQ",
        "target" : "RGl6ZFIwgQPibJ-MHe8Rb$$JV22k_HuneKsH1UBkNu4C",
        "targetPort" : "ODRdFY6XbX0N2o2LzfYUR$$6YgoEofADuAxNEIpmNKRe"
      }, {
        "id" : "_ohwJ5NvZdXckImMKcSTO",
        "source" : "EQU4Ir3ryehzsVSS6hUJ8$$w2o7GEJsF0XAdbwN9rkwn",
        "sourcePort" : "uxbZzVEDgRP5EYZNUqZvj$$qrGSgAmr5F6bcd0i3bVVI",
        "target" : "8ylYJ1tX86fOVqXBsOzQs$$ZLl07RviPbapbK0aZ_joJ",
        "targetPort" : "2LAyuu46Z3r8HMPKu7MNL$$mqPedQYvocM8yaOABHaIf"
      }, {
        "id" : "P4Mg2q7d1OyL-CfZ5R_hH",
        "source" : "8ylYJ1tX86fOVqXBsOzQs$$ZLl07RviPbapbK0aZ_joJ",
        "sourcePort" : "ZXTOPBj6hjy-RMM6ABfQ8$$aqod66smJrMwsiBGfa5Xt",
        "target" : "A9x2xN2P7Stiwp5zuGjZ1$$0NK_8M9qkE6Vc55CgNhKh",
        "targetPort" : "t9nIcjNLa5QL5XrpLIYpj$$Wvc9-Ywz0o1CyCtUtFHRC"
      } ],
      "processes" : {
        "A9x2xN2P7Stiwp5zuGjZ1$$0NK_8M9qkE6Vc55CgNhKh" : {
          "id" : "A9x2xN2P7Stiwp5zuGjZ1$$0NK_8M9qkE6Vc55CgNhKh",
          "component" : "Target",
          "metadata" : {
            "label" : "Copper_Delta_Table",
            "slug" : "Copper_Delta_Table",
            "x" : 1120,
            "y" : 160,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "t9nIcjNLa5QL5XrpLIYpj$$Wvc9-Ywz0o1CyCtUtFHRC",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Copper_Delta_Table"
          }
        },
        "RGl6ZFIwgQPibJ-MHe8Rb$$JV22k_HuneKsH1UBkNu4C" : {
          "id" : "RGl6ZFIwgQPibJ-MHe8Rb$$JV22k_HuneKsH1UBkNu4C",
          "component" : "Script",
          "metadata" : {
            "label" : "Duplicate_Record_Logger",
            "slug" : "Duplicate_Record_Logger",
            "x" : 820,
            "y" : 420,
            "phase" : 2,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "ODRdFY6XbX0N2o2LzfYUR$$6YgoEofADuAxNEIpmNKRe",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nfrom datetime import datetime\r\n\r\nerror_table = f\"{Config.var_catalog_name}.{Config.var_log_schema}.etl_error_log\"\r\nvar_timestp = f\"{Config.var_start_timestamp}\"\r\nif not in0.isEmpty():\r\n    ts_val = datetime.strptime(var_timestp, \"%Y-%m-%d %H:%M:%S\")\r\n    src_table_val = f\"{Config.file_prefix}{Config.file_type}\"\r\n    json_bad_dataframe = in0.select(\r\n                        lit(ts_val).alias(\"ins_tms\"),\r\n                        lit(f\"{Config.var_bus_dt}\").alias(\"bus_dt\"),\r\n                        lit(src_table_val).alias(\"src_table\"),\r\n                        lit(f\"{Config.bronze_table}\").alias(\"tgt_table\"),\r\n                        lit(\"Write duplicated records for \" f\"{Config.bronze_table}\").alias(\"error_message\"),\r\n                        lit(f\"{Config.var_copper_schema}\").alias(\"error_stage\"),\r\n                        to_json(struct(\"*\"), options={\"ignoreNullFields\": \"false\"}).alias(\"data_payload\"),\r\n                        lit(f\"{Config.var_wkf_name}\").alias(\"wkf_name\"),\r\n                        lit(f\"{Config.var_wkf_run_id}\").alias(\"wkf_run_id\"),\r\n                        lit(f\"{Config.var_task_name}\").alias(\"task_name\"),\r\n                        lit(f\"{Config.var_task_run_id}\").alias(\"task_run_id\")\r\n    ).write.format(\"delta\").mode(\"append\").saveAsTable(error_table)\r\n    copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n    log_message = f\"Write duplicate records for {Config.bronze_table}: {in0.count()} \"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n\r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            #in0.count(),\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            in0.count(),\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n    )",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "sT8wc7gAzgF8OxaLz65O7$$uyPsfPVjHzJgHFjjiSIgd" : {
          "id" : "sT8wc7gAzgF8OxaLz65O7$$uyPsfPVjHzJgHFjjiSIgd",
          "component" : "ControlFlowInput",
          "metadata" : {
            "label" : "TableIterator_Input",
            "slug" : "TableIterator_Input",
            "x" : 0,
            "y" : 0,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ {
              "id" : "341lAGp1exTo7CLvHdBfr$$xTgEczadt_Uv-cXbTIh-u",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "bronze_table",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the initial storage table for raw data.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "raw_file_path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "File path where the raw data is stored.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_prefix",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Prefix used in naming the raw data files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Format of the raw data files, such as CSV or JSON.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encryption_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Method used to encrypt the raw data files for security.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "field_separator",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Character used to separate fields in the dataset files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "part_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file is a part of a larger file set.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "keys_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file contains key information for processing.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "headers_in_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates whether the file includes headers.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "full_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is a full load.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "inc_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "critical",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicator of the dataset's importance or priority level.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "business_keys",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifiers used to distinguish records in the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tie_breaker_column",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enabled",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is currently active or operational.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ins_dtm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 1,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowInput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "hmaPn0L5Tb-hACLWWvZ8N$$ELfGV_GpBwpdVJZ-Yt5_U" : {
          "id" : "hmaPn0L5Tb-hACLWWvZ8N$$ELfGV_GpBwpdVJZ-Yt5_U",
          "component" : "Script",
          "metadata" : {
            "label" : "Defensive_checks_UDF",
            "slug" : "Defensive_checks_UDF",
            "x" : 220,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "GU9GM2lodTVLaqRx_zeDB$$q7KLy1Remb3p76zAtSfdY",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "size",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "creation_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "modification_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parent_directory",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nimport fnmatch\r\n\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nfile_prefix = f\"{Config.file_prefix}\" + \"*\" + f\"{Config.file_type}\"\r\n\r\nreturn_df_row=[]\r\n\r\nif in0.isEmpty():\r\n    log_message = (\r\n        f\"The directory abfss://{Config.var_raw_container}@\"\r\n        f\"{Config.var_raw_storage_account}{Config.raw_file_path} is empty\"\r\n    )\r\n    tao_custom_logger(\r\n        Config.var_error_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    Config.var_matching_files = False\r\n    \r\nelse:\r\n    log_message = \"Files found in the directory:\\n\"\r\n    for row in in0.collect():\r\n        size_in_mb = f\"{row.size / (1024 * 1024):.2f} MB\"\r\n        log_message += (\r\n            f\"Path={row.path}, Name={row.name}, Size={size_in_mb}, \"\r\n            f\"ModificationTime={row.modification_time}\\n\"\r\n        )\r\n    tao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    file_names = [row.name for row in in0.select(\"name\").collect()]\r\n    nr_files = len(file_names)\r\n    matching_files = fnmatch.filter(file_names, file_prefix)\r\n    nr_matching_files = len(matching_files)\r\n    if matching_files:\r\n            log_message = f\"Files matching the pattern are {matching_files}. Number of matching files: {nr_matching_files}, out of a total of {nr_files} files\"\r\n            tao_custom_logger(\r\n                Config.var_info_type,\r\n                Config.var_file_check,\r\n                log_message,\r\n                Config.bronze_table,\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            Config.var_matching_files = True\r\n    \r\n    else:\r\n        log_message = f\"No files matching the pattern were found. List of files found: {file_names}\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n        Config.var_matching_files = False\r\n\r\n#return_df_row=[(0)]\r\n#return_df = spark.createDataFrame(return_df_row,[\"return_df_row\"])\r\n#return return_df",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "0W_TQMu339RTml913qSyn$$PzmmEW6OXmoExxCslfyVv" : {
          "id" : "0W_TQMu339RTml913qSyn$$PzmmEW6OXmoExxCslfyVv",
          "component" : "Script",
          "metadata" : {
            "label" : "Read_Deduplicate_Write_Delta",
            "slug" : "Read_Deduplicate_Write_Delta",
            "x" : 420,
            "y" : 320,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "yMyVowaU-OQMn8h0P8MIU$$oqtt_kixmOA-V97X1Y8Jr",
              "slug" : "copper_raw_dataframe",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false,
              "dataExplorerProps" : {
                "filter" : {
                  "type" : "Composite",
                  "op" : {
                    "type" : "AND"
                  },
                  "filters" : [ ]
                },
                "sorts" : [ ]
              }
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from datetime import datetime\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n\r\nglob_filter = f\"*{Config.file_type}\"\r\n\r\n# Remove the '.' from '.csv'\r\nclean_file_type = Config.file_type.replace(\".\", \"\")  # \".csv\" -> \"csv\"\r\n\r\n# Single f-string (avoid multiple adjacent f-strings that parser may flag)\r\n# If parser still errors, collapse to:\r\nraw_file_directory_path = f\"abfss://{Config.var_raw_container}@{Config.var_raw_storage_account}.dfs.core.windows.net{Config.raw_file_path}\"\r\n\r\nif Config.var_matching_files:\r\n    csv_opts = {\r\n    \"header\": \"true\",\r\n    \"multiLine\": \"true\",\r\n    \"sep\": f\"{Config.field_separator}\",\r\n    \"pathGlobFilter\": glob_filter,\r\n    \"escape\": '\"'\r\n}\r\n\r\n    copper_dataframe = tao_safe_read(\r\n        raw_file_directory_path,\r\n        clean_file_type,\r\n        description=f\"Read raw files for {Config.bronze_table}\",\r\n        copper_table=Config.bronze_table,\r\n        options=csv_opts,\r\n        severity=Config.var_error_type,\r\n        log_type=Config.var_log_type_generic\r\n    )\r\nelse:\r\n    copper_dataframe = None\r\n\r\nprint(copper_dataframe)\r\n\r\ndate_obj = datetime.strptime(Config.var_extract_bus_dt_tao_sfic, '%Y%m%d').date()\r\nprint(date_obj)  # Output: 2025-09-15\r\n\r\ntry:\r\n    #message = f\"Add metadata columns for {Config.bronze_table}\"\r\n    log_message = (\r\n        f\"Add metadata columns for {Config.bronze_table}\"\r\n    )\r\n    copper_dataframe = copper_dataframe.withColumn(Config.var_aux_insert_datetime, current_timestamp()) \\\r\n        .withColumn(Config.var_aux_updated_datetime, lit(None).cast(TimestampType())) \\\r\n        .withColumn(Config.var_aux_extract_bus_date, lit(str(date_obj)).cast(StringType())) \\\r\n        .withColumn(Config.var_aux_updated_extract_bus_date, lit(None).cast(StringType()))\r\n\r\n    \r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    \r\n    # check if there are duplicates\r\n    #message = f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    log_message = (\r\n        f\"Deduplication for {Config.bronze_table}\"\r\n    )\r\n    #partition_columns_list = [col(c.strip()) for c in Config.business_keys.split(\",\")]\r\n    business_key_names = [c.strip() for c in Config.business_keys.split(\",\") if c.strip()]\r\n    missing = [keys for keys in business_key_names if keys not in copper_dataframe.columns]\r\n    if missing:\r\n       raise ValueError(f\" :{missing}\") \r\n\r\n    partition_columns_list = [col(k) for k in business_key_names]   \r\n    if Config.tie_breaker_column is None:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(lit(1))\r\n    else:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(copper_dataframe[Config.tie_breaker_column].desc())\r\n\r\n    copper_dataframe_ranked = copper_dataframe.withColumn(\"row_number\", row_number().over(window_spec))\r\n\r\n    #delta_dataframe = copper_dataframe_ranked.filter(copper_dataframe_ranked[\"row_number\"] == 1).drop(\"row_number\")\r\n    #error_dataframe = copper_dataframe_ranked.filter(copper_dataframe_ranked[\"row_number\"] > 1).drop(\"row_number\")\r\n    \r\n    return copper_dataframe_ranked\r\nexcept Exception as e:\r\n    \r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message = \"Error during transform->\"+ log_message+ str(e)\r\n    \r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    #raise\r\n    return copper_dataframe    \r\n",
            "scriptMethodHeader" : "def Script(spark: SparkSession) -> DataFrame:",
            "scriptMethodFooter" : "    return copper_raw_dataframe"
          }
        },
        "E4PIwmGvQozEOyhIWT-Ox$$3YjVIffoqDu6TnzLo_GDB" : {
          "id" : "E4PIwmGvQozEOyhIWT-Ox$$3YjVIffoqDu6TnzLo_GDB",
          "component" : "ControlFlowOutput",
          "metadata" : {
            "label" : "TableIterator_Output",
            "slug" : "TableIterator_Output",
            "x" : 0,
            "y" : 0,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 0,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowOutput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "8ylYJ1tX86fOVqXBsOzQs$$ZLl07RviPbapbK0aZ_joJ" : {
          "id" : "8ylYJ1tX86fOVqXBsOzQs$$ZLl07RviPbapbK0aZ_joJ",
          "component" : "Script",
          "metadata" : {
            "label" : "Drop_col_log_Copper_Load",
            "slug" : "Drop_col_log_Copper_Load",
            "x" : 920,
            "y" : -60,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "2LAyuu46Z3r8HMPKu7MNL$$mqPedQYvocM8yaOABHaIf",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ZXTOPBj6hjy-RMM6ABfQ8$$aqod66smJrMwsiBGfa5Xt",
              "slug" : "Copper_Delta_Table",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nlog_message = f\"Rows inserted in {Config.bronze_table}: {in0.count()} \"\r\n#log_message = (\r\n#    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n#    f\"{message}\"\r\n#)\r\n\r\ntao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_row_count,\r\n        log_message,\r\n        #in0.count(),\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        in0.count(),\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n)\r\n\r\ncopper_delta_table = in0.drop(\"row_number\")\r\nreturn copper_delta_table",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return Copper_Delta_Table"
          }
        },
        "_iklIP4He6ORS15dW1P8F$$9I36ngxrOj4GoOGLgUE8A" : {
          "id" : "_iklIP4He6ORS15dW1P8F$$9I36ngxrOj4GoOGLgUE8A",
          "component" : "Directory",
          "metadata" : {
            "label" : "Directory_Listing",
            "slug" : "Directory_Listing",
            "x" : 20,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : true
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "fUQvKLVFplxz3m0eoRLgf$$kW7SxGwnoQZeIQoY3d-wE",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "path" : "abfss://${var_raw_container}@${var_raw_storage_account}.dfs.core.windows.net${raw_file_path}",
            "includeSubDirs" : true,
            "filePattern" : "*.*"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Directory",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "EQU4Ir3ryehzsVSS6hUJ8$$w2o7GEJsF0XAdbwN9rkwn" : {
          "id" : "EQU4Ir3ryehzsVSS6hUJ8$$w2o7GEJsF0XAdbwN9rkwn",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "RowDistributor_1",
            "slug" : "RowDistributor_1",
            "x" : 620,
            "y" : 320,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Yld8q34WQ5aKdDjxRY1HK$$PJ7L0Lrct_reID1vABnWU",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "uxbZzVEDgRP5EYZNUqZvj$$qrGSgAmr5F6bcd0i3bVVI",
              "slug" : "out0"
            }, {
              "id" : "gEyDIgOkP6NHILoT1Uocv$$nUib_T9orO2dgFOXHMagQ",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "uxbZzVEDgRP5EYZNUqZvj$$qrGSgAmr5F6bcd0i3bVVI",
              "model" : {
                "format" : "sql",
                "expression" : "row_number=1"
              }
            }, {
              "path" : "out1",
              "id" : "gEyDIgOkP6NHILoT1Uocv$$nUib_T9orO2dgFOXHMagQ",
              "model" : {
                "format" : "sql",
                "expression" : "row_number>1"
              }
            } ],
            "distributeUnmatchedRows" : null
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/TableIterator",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "aYh0xCywT-3RjcGP_nkMZ$$jmyeHKLuR7J6cXl6ALyGP" : {
      "id" : "aYh0xCywT-3RjcGP_nkMZ$$jmyeHKLuR7J6cXl6ALyGP",
      "component" : "Filter",
      "metadata" : {
        "label" : "Keys_Control_Table",
        "slug" : "Keys_Control_Table",
        "x" : 220,
        "y" : 20,
        "phase" : 2,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "vXuMuQ1l-DavhEm0F5O5r$$Vus58OKxipeuXn2_vYLXz",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Elei47HzyTL4N-iqemdt1$$dzLoCnL_9GrfRlIJ4O9CA",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "vXuMuQ1l-DavhEm0F5O5r$$Vus58OKxipeuXn2_vYLXz##keys_file", "vXuMuQ1l-DavhEm0F5O5r$$Vus58OKxipeuXn2_vYLXz##full_load" ],
        "condition" : {
          "format" : "sql",
          "expression" : "keys_file = 1 and full_load = 0"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "x9UaY2J7gSIcPt4uBIbug$$zeQIlSpGQSDcmCnNtrSNS" : {
      "id" : "x9UaY2J7gSIcPt4uBIbug$$zeQIlSpGQSDcmCnNtrSNS",
      "component" : "TableIterator",
      "metadata" : {
        "label" : "Full_Load_for_Inc",
        "slug" : "Full_Load_for_Inc",
        "x" : 420,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "Config.var_full_load_mode_sfic_tao  == \"0\"",
        "dataPreview" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "0EfUC57-vP4u0lDzETIc9$$RZ_eFzhjcy_eO4XVgC6n2",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "bronze_table",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the initial storage table for raw data.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "raw_file_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "File path where the raw data is stored.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_prefix",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Prefix used in naming the raw data files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "file_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Format of the raw data files, such as CSV or JSON.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "encryption_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Method used to encrypt the raw data files for security.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "field_separator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Character used to separate fields in the dataset files.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "part_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file is a part of a larger file set.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keys_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates if the file contains key information for processing.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "headers_in_file",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates whether the file includes headers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "full_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is a full load.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inc_load",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "critical",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicator of the dataset's importance or priority level.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "business_keys",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifiers used to distinguish records in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tie_breaker_column",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "enabled",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Flag indicating if the dataset is currently active or operational.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ins_dtm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "metagemProperty" : {
          "availableColumnNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm" ],
          "availableConfigFieldNames" : [ "bronze_table", "raw_file_path", "file_prefix", "file_type", "encryption_type", "field_separator", "part_file", "keys_file", "headers_in_file", "full_load", "inc_load", "critical", "business_keys", "tie_breaker_column", "enabled", "ins_dtm", "var_raw_container", "var_raw_storage_account", "var_copper_container", "var_delta_storage_account", "var_catalog_name", "var_etl_schema", "var_copper_schema", "var_bus_dt", "var_log_container", "var_warning_type", "var_info_type", "var_error_type", "var_file_check", "var_bus_dt_dt", "var_wkf_name", "var_task_name", "var_task_run_id", "var_wkf_run_id", "var_start_timestamp", "var_src_tao_sfic", "var_src_tao_snow", "var_src_tao_8fold", "var_matching_files", "var_aux_insert_datetime", "var_aux_updated_datetime", "var_aux_extract_bus_date", "var_aux_updated_extract_bus_date", "var_extract_bus_dt_tao_sfic", "var_log_type_generic", "var_log_schema", "var_full_load_mode_sfic_tao" ],
          "numberOfThreads" : "5",
          "maxIteration" : "1000",
          "parallelismEnabled" : false,
          "configToColumnMap" : [ {
            "configName" : "bronze_table",
            "columnName" : "bronze_table"
          }, {
            "configName" : "raw_file_path",
            "columnName" : "raw_file_path"
          }, {
            "configName" : "file_prefix",
            "columnName" : "file_prefix"
          }, {
            "configName" : "file_type",
            "columnName" : "file_type"
          }, {
            "configName" : "encryption_type",
            "columnName" : "encryption_type"
          }, {
            "configName" : "field_separator",
            "columnName" : "field_separator"
          }, {
            "configName" : "part_file",
            "columnName" : "part_file"
          }, {
            "configName" : "keys_file",
            "columnName" : "keys_file"
          }, {
            "configName" : "headers_in_file",
            "columnName" : "headers_in_file"
          }, {
            "configName" : "full_load",
            "columnName" : "full_load"
          }, {
            "configName" : "inc_load",
            "columnName" : "inc_load"
          }, {
            "configName" : "critical",
            "columnName" : "critical"
          }, {
            "configName" : "business_keys",
            "columnName" : "business_keys"
          }, {
            "configName" : "tie_breaker_column",
            "columnName" : "tie_breaker_column"
          }, {
            "configName" : "enabled",
            "columnName" : "enabled"
          }, {
            "configName" : "ins_dtm",
            "columnName" : "ins_dtm"
          } ]
        }
      },
      "connections" : [ {
        "id" : "JmrfvyHKb9wWuXE1wIiiH",
        "source" : "x9UaY2J7gSIcPt4uBIbug$$zeQIlSpGQSDcmCnNtrSNS",
        "sourcePort" : "0EfUC57-vP4u0lDzETIc9$$RZ_eFzhjcy_eO4XVgC6n2",
        "target" : "5tNPEDwi5D_iCPNBZuEhp$$G31mxEP4zDUWPzvP5FYqJ",
        "targetPort" : "v4WHOGi--JjSS1EhV1h3o$$XTUICRCq39DaoDAyY0Rrh",
        "visualProperty" : {
          "isHidden" : true
        }
      }, {
        "id" : "A_ICJjoOsD5X2LKYMV7wQ",
        "source" : "6GW2xIOUUM3ticn79h-Ki$$DjAzJaowL8dswGYbaWw0S",
        "sourcePort" : "yQHKWPkn_RjNcgG-vQrpq$$kRYOpfpahJrYXn1QZdnBr",
        "target" : "DvK0Xgl6FGt90O3xW_9GP$$9NPW1PFNZCi8zmdB-M6-k",
        "targetPort" : "tgFMue4bUXoWv2HWmyowm$$y7Vqu6Pg1lkjsnMyq5Ykz"
      }, {
        "id" : "VEA6h_By6i-KCmbc4uTVF",
        "source" : "DvK0Xgl6FGt90O3xW_9GP$$9NPW1PFNZCi8zmdB-M6-k",
        "sourcePort" : "vLcYWqCqCAPa0cMSgu-Vb$$rOL3sjQXUOK6jT23esOp8",
        "target" : "NRwF4ToM_FGDgxMLPVD0F$$qFl6HEdZwmiZu8TAlOJh1",
        "targetPort" : "OPtxJ2uhbhAwI4ZOo9wic$$XMsiIb5hPsKGzXArfkxVi"
      }, {
        "id" : "4JfFU8Bep8S-fkV5Z7iHC",
        "source" : "NRwF4ToM_FGDgxMLPVD0F$$qFl6HEdZwmiZu8TAlOJh1",
        "sourcePort" : "_82gEYjV8QuIZtN5PE1Aq$$A-jIfdNdqTISdsvDVjL7w",
        "target" : "MuIDmTjkuDrgWhdyOua6e$$-qCaiq3g_NbsoUtRF8jw1",
        "targetPort" : "nTwLN3o_FL5T7nPoN224b$$eL8gEwhvuB-p5TnwVHKTA"
      }, {
        "id" : "F9jpbxoWdSkvfGVsv6mH3",
        "source" : "MuIDmTjkuDrgWhdyOua6e$$-qCaiq3g_NbsoUtRF8jw1",
        "sourcePort" : "Y0-ZMWa5wU79MoCIsDfyP$$0HAbZEq3DLG6HDmwJUpVs",
        "target" : "JA6_0kXg2xhfRamysmPg4$$V7TWVQR7FQT_0FJHNY-aV",
        "targetPort" : "RRnl5sYq6B_aBpt6pfCEg$$ZitvAR9gw0XwjPpGfOoC8"
      }, {
        "id" : "yOCY0dDmZF7scJ9eJPhkm",
        "source" : "MuIDmTjkuDrgWhdyOua6e$$-qCaiq3g_NbsoUtRF8jw1",
        "sourcePort" : "Db9F8-U0JP_kj1ea7kduP$$fPxCT_uwfMiWwoGPbH9SG",
        "target" : "Ihw6qJNZHYfJqVnx2vBW7$$fkb0JqiP-Qn3b8CZIXfW9",
        "targetPort" : "eFiM2XqxSLglWu9USO35t$$TYjN6LsW-iHZxC_e5GR4-"
      }, {
        "id" : "Uwg8wONtkGp95mbZAxH1D",
        "source" : "Ihw6qJNZHYfJqVnx2vBW7$$fkb0JqiP-Qn3b8CZIXfW9",
        "sourcePort" : "tjLz80BfjWA_glv6JNNjF$$RH5mwfrmlQM1ow1M54Ghn",
        "target" : "rjNfD8ej-JBlyRTcYs4CK$$D0sG0unGawCG4YhyosmaL",
        "targetPort" : "OOUBMKsSkQUnEXxUwB9FE$$rXA_npV42W2YVyvnD6maZ"
      } ],
      "processes" : {
        "rjNfD8ej-JBlyRTcYs4CK$$D0sG0unGawCG4YhyosmaL" : {
          "id" : "rjNfD8ej-JBlyRTcYs4CK$$D0sG0unGawCG4YhyosmaL",
          "component" : "Target",
          "metadata" : {
            "label" : "Copper_Delta_Table_1",
            "slug" : "Copper_Delta_Table_1",
            "x" : 1280,
            "y" : 120,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "OOUBMKsSkQUnEXxUwB9FE$$rXA_npV42W2YVyvnD6maZ",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/Copper_Delta_Table"
          }
        },
        "NRwF4ToM_FGDgxMLPVD0F$$qFl6HEdZwmiZu8TAlOJh1" : {
          "id" : "NRwF4ToM_FGDgxMLPVD0F$$qFl6HEdZwmiZu8TAlOJh1",
          "component" : "Script",
          "metadata" : {
            "label" : "Read_Deduplicate_Write_Delta_1",
            "slug" : "Read_Deduplicate_Write_Delta_1",
            "x" : 680,
            "y" : 220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "OPtxJ2uhbhAwI4ZOo9wic$$XMsiIb5hPsKGzXArfkxVi",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "_82gEYjV8QuIZtN5PE1Aq$$A-jIfdNdqTISdsvDVjL7w",
              "slug" : "copper_raw_dataframe",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false,
              "dataExplorerProps" : {
                "filter" : {
                  "type" : "Composite",
                  "op" : {
                    "type" : "AND"
                  },
                  "filters" : [ ]
                },
                "sorts" : [ ]
              }
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from datetime import datetime\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\n\r\nglob_filter = f\"*{Config.file_type}\"\r\n\r\n# Remove the '.' from '.csv'\r\nclean_file_type = Config.file_type.replace(\".\", \"\")  # \".csv\" -> \"csv\"\r\n\r\n# Single f-string (avoid multiple adjacent f-strings that parser may flag)\r\n# If parser still errors, collapse to:\r\nraw_file_directory_path = f\"abfss://{Config.var_raw_container}@{Config.var_raw_storage_account}.dfs.core.windows.net{Config.raw_file_path}\"\r\n\r\nif Config.var_matching_files:\r\n    csv_opts = {\r\n    \"header\": \"true\",\r\n    \"multiLine\": \"true\",\r\n    \"sep\": f\"{Config.field_separator}\",\r\n    \"pathGlobFilter\": glob_filter,\r\n    \"escape\": '\"'\r\n}\r\n\r\n    copper_dataframe = tao_safe_read(\r\n        raw_file_directory_path,\r\n        clean_file_type,\r\n        description=f\"Read raw files for {Config.bronze_table}\",\r\n        copper_table=Config.bronze_table,\r\n        options=csv_opts,\r\n        severity=Config.var_error_type,\r\n        log_type=Config.var_log_type_generic\r\n    )\r\nelse:\r\n    copper_dataframe = None\r\n\r\nprint(copper_dataframe)\r\n\r\ndate_obj = datetime.strptime(Config.var_extract_bus_dt_tao_sfic, '%Y%m%d').date()\r\n\r\ntry:\r\n    log_message = f\"Add metadata columns for {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"Add metadata columns for {Config.bronze_table}\"\r\n    #)\r\n    copper_dataframe = copper_dataframe.withColumn(Config.var_aux_insert_datetime, current_timestamp()) \\\r\n        .withColumn(Config.var_aux_updated_datetime, lit(None).cast(TimestampType())) \\\r\n        .withColumn(Config.var_aux_extract_bus_date, lit(str(date_obj)).cast(StringType())) \\\r\n        .withColumn(Config.var_aux_updated_extract_bus_date, lit(None).cast(StringType()))\r\n\r\n    \r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    \r\n    # check if there are duplicates\r\n    log_message = f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"Deduplication using row_number for {Config.bronze_table}\"\r\n    #)\r\n    partition_columns_list = [col(c.strip()) for c in Config.business_keys.split(\",\")]\r\n    if Config.tie_breaker_column is None:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(lit(1))\r\n    else:\r\n        window_spec = Window.partitionBy(*partition_columns_list).orderBy(copper_dataframe[Config.tie_breaker_column].desc())\r\n\r\n    copper_dataframe_ranked = copper_dataframe.withColumn(\"row_number\", row_number().over(window_spec))\r\n\r\n    #delta_dataframe = copper_dataframe_ranked.filter(copper_dataframe_ranked[\"row_number\"] == 1).drop(\"row_number\")\r\n    #error_dataframe = copper_dataframe_ranked.filter(copper_dataframe_ranked[\"row_number\"] > 1).drop(\"row_number\")\r\n    \r\n    return copper_dataframe_ranked\r\nexcept Exception as e:\r\n    \r\n    #log_message = (\r\n    #    f\"[{Config.var_error_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #)  \r\n    \r\n    log_message = \"Error during transform->\"+ log_message+ str(e)\r\n    tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n    raise    \r\n",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return copper_raw_dataframe"
          }
        },
        "JA6_0kXg2xhfRamysmPg4$$V7TWVQR7FQT_0FJHNY-aV" : {
          "id" : "JA6_0kXg2xhfRamysmPg4$$V7TWVQR7FQT_0FJHNY-aV",
          "component" : "Script",
          "metadata" : {
            "label" : "Duplicate_Record_Logger_1",
            "slug" : "Duplicate_Record_Logger_1",
            "x" : 1080,
            "y" : 320,
            "phase" : 1,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "RRnl5sYq6B_aBpt6pfCEg$$ZitvAR9gw0XwjPpGfOoC8",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nfrom datetime import datetime\r\n\r\nerror_table = f\"{Config.var_catalog_name}.{Config.var_log_schema}.etl_error_log\"\r\nvar_timestp = f\"{Config.var_start_timestamp}\"\r\nif not in0.isEmpty():\r\n    ts_val = datetime.strptime(var_timestp, \"%Y-%m-%d %H:%M:%S\")\r\n    src_table_val = f\"{Config.file_prefix}{Config.file_type}\"\r\n    json_bad_dataframe = in0.select(\r\n                        lit(ts_val).alias(\"ins_tms\"),\r\n                        lit(f\"{Config.var_bus_dt}\").alias(\"bus_dt\"),\r\n                        lit(src_table_val).alias(\"src_table\"),\r\n                        lit(f\"{Config.bronze_table}\").alias(\"tgt_table\"),\r\n                        lit(\"Write duplicated records for \" f\"{Config.bronze_table}\").alias(\"error_message\"),\r\n                        lit(f\"{Config.var_copper_schema}\").alias(\"error_stage\"),\r\n                        to_json(struct(\"*\"), options={\"ignoreNullFields\": \"false\"}).alias(\"data_payload\"),\r\n                        lit(f\"{Config.var_wkf_name}\").alias(\"wkf_name\"),\r\n                        lit(f\"{Config.var_wkf_run_id}\").alias(\"wkf_run_id\"),\r\n                        lit(f\"{Config.var_task_name}\").alias(\"task_name\"),\r\n                        lit(f\"{Config.var_task_run_id}\").alias(\"task_run_id\")\r\n    ).write.format(\"delta\").mode(\"append\").saveAsTable(error_table)\r\n    log_message = f\"Write duplicate records for {Config.bronze_table}: {in0.count()} \"\r\n    #log_message = (\r\n    #    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n    #    f\"{message}\"\r\n    #)\r\n\r\n    tao_custom_logger(\r\n            Config.var_info_type,\r\n            Config.var_row_count,\r\n            log_message,\r\n            #in0.count(),\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            in0.count(),\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n    )",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> None:",
            "scriptMethodFooter" : "    return "
          }
        },
        "aT1d5KRoiRWABj0Vf_TfY$$LS8MqnxJ50D8mbz9qTjc2" : {
          "id" : "aT1d5KRoiRWABj0Vf_TfY$$LS8MqnxJ50D8mbz9qTjc2",
          "component" : "ControlFlowOutput",
          "metadata" : {
            "label" : "TableIterator_Output_1",
            "slug" : "TableIterator_Output_1",
            "x" : 268.39996337890625,
            "y" : -100.79166870117189,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 0,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowOutput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "Ihw6qJNZHYfJqVnx2vBW7$$fkb0JqiP-Qn3b8CZIXfW9" : {
          "id" : "Ihw6qJNZHYfJqVnx2vBW7$$fkb0JqiP-Qn3b8CZIXfW9",
          "component" : "Script",
          "metadata" : {
            "label" : "Drop_col_log_Copper_Load_Full_INC",
            "slug" : "Drop_col_log_Copper_Load_Full_INC",
            "x" : 1000,
            "y" : -160,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "eFiM2XqxSLglWu9USO35t$$TYjN6LsW-iHZxC_e5GR4-",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "tjLz80BfjWA_glv6JNNjF$$RH5mwfrmlQM1ow1M54Ghn",
              "slug" : "Copper_Delta_Table",
              "schema" : {
                "type" : "struct",
                "fields" : [ ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "copper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nlog_message = f\"Rows inserted in {Config.bronze_table}: {in0.count()} \"\r\n#log_message = (\r\n#    f\"[{Config.var_info_type}][{Config.var_log_type_generic}][{Config.bronze_table}]\"\r\n#    f\"{message}\"\r\n#)\r\n\r\ntao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_row_count,\r\n        log_message,\r\n        #in0.count(),\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        in0.count(),\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n)\r\n\r\ncopper_delta_table = in0.drop(\"row_number\")\r\nreturn copper_delta_table",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return Copper_Delta_Table"
          }
        },
        "MuIDmTjkuDrgWhdyOua6e$$-qCaiq3g_NbsoUtRF8jw1" : {
          "id" : "MuIDmTjkuDrgWhdyOua6e$$-qCaiq3g_NbsoUtRF8jw1",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "RowDistributor_1_1",
            "slug" : "RowDistributor_1_1",
            "x" : 880,
            "y" : 220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "nTwLN3o_FL5T7nPoN224b$$eL8gEwhvuB-p5TnwVHKTA",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "jobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "age",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "appTemplateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "assessRatingScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "businessUnitCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateHired",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "candidateProgress",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "closedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "corporatePosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "costCenterCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "country",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "createdDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "currency",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custEducation",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrJobPosting3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrOrgData",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt2",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt3",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt4",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrPosMgmt5",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrReqDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custInstrTeamDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custWorkHrs",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BrandURL",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_BudgetedFromDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_EmailSignOff",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FinanceCostCentre",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_FixedTermContractLength",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_IntakeMeetingDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_PostingContactEmail",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_ProjectName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Qualification",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_Workforce_Plan_ID",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_addSourcingDetails",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_extjobadvert",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_locationcity",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMax",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMaxUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMed",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMin",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_rangeMinUSA",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "cust_reqTitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrAssessment",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "custinstrVetting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "defaultLanguage",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "deleted",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "departmentCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "divisionCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "erpAmount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "evergreen",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDataId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formDueDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagerName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "functionalManagertitle",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "hiringManagerNote",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "instrInternalComments",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "internalStatus",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "intranetPosting",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "isDraft",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobReqGUId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "jobStartDate",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedBy",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedDateTime",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lastModifiedProxyUserId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "legalEntityCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "locationCode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "numberOpenings",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "openingsFilled",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "overallScaleName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parentJobReqId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "positionNumber",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "quickApply",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ratedApplicantCount",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "reverseScale",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "sfstd_jobReqType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "statusSetId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "targetFTE",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateId",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "templateType",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "timeToFill",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_ins_dtm",
                  "type" : "timestamp",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_dtm",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_extract_bus_dt",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "aux_upd_extract_bus_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "row_number",
                  "type" : "integer",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Db9F8-U0JP_kj1ea7kduP$$fPxCT_uwfMiWwoGPbH9SG",
              "slug" : "out0"
            }, {
              "id" : "Y0-ZMWa5wU79MoCIsDfyP$$0HAbZEq3DLG6HDmwJUpVs",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "Db9F8-U0JP_kj1ea7kduP$$fPxCT_uwfMiWwoGPbH9SG",
              "model" : {
                "format" : "sql",
                "expression" : "row_number=1"
              }
            }, {
              "path" : "out1",
              "id" : "Y0-ZMWa5wU79MoCIsDfyP$$0HAbZEq3DLG6HDmwJUpVs",
              "model" : {
                "format" : "sql",
                "expression" : "row_number>1"
              }
            } ],
            "distributeUnmatchedRows" : null
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "DvK0Xgl6FGt90O3xW_9GP$$9NPW1PFNZCi8zmdB-M6-k" : {
          "id" : "DvK0Xgl6FGt90O3xW_9GP$$9NPW1PFNZCi8zmdB-M6-k",
          "component" : "Script",
          "metadata" : {
            "label" : "Defensive_checks_UDF_1",
            "slug" : "Defensive_checks_UDF_1",
            "x" : 480,
            "y" : 220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "tgFMue4bUXoWv2HWmyowm$$y7Vqu6Pg1lkjsnMyq5Ykz",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "size",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "creation_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "modification_time",
                  "type" : "timestamp",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "parent_directory",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "vLcYWqCqCAPa0cMSgu-Vb$$rOL3sjQXUOK6jT23esOp8",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "return_df_row",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : true
          },
          "properties" : {
            "script" : "from pyspark.sql import functions as F\r\nimport fnmatch\r\n\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\nfile_prefix = f\"{Config.file_prefix}\" + \"*\" + f\"{Config.file_type}\"\r\n\r\nreturn_df_row=[]\r\n\r\nif in0.isEmpty():\r\n    log_message = (\r\n        f\"The directory abfss://{Config.var_raw_container}@\"\r\n        f\"{Config.var_raw_storage_account}{Config.raw_file_path} is empty\"\r\n    )\r\n    tao_custom_logger(\r\n        Config.var_error_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    Config.var_matching_files = False\r\n\r\nelse:\r\n    log_message = \"Files found in the directory:\\n\"\r\n    for row in in0.collect():\r\n        size_in_mb = f\"{row.size / (1024 * 1024):.2f} MB\"\r\n        log_message += (\r\n            f\"Path={row.path}, Name={row.name}, Size={size_in_mb}, \"\r\n            f\"ModificationTime={row.modification_time}\\n\"\r\n        )\r\n    tao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_file_check,\r\n        log_message,\r\n        Config.bronze_table,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    file_names = [row.name for row in in0.select(\"name\").collect()]\r\n    nr_files = len(file_names)\r\n    matching_files = fnmatch.filter(file_names, file_prefix)\r\n    nr_matching_files = len(matching_files)\r\n    if matching_files:\r\n            log_message = f\"Files matching the pattern are {matching_files}. Number of matching files: {nr_matching_files}, out of a total of {nr_files} files\"\r\n            tao_custom_logger(\r\n                Config.var_info_type,\r\n                Config.var_file_check,\r\n                log_message,\r\n                Config.bronze_table,\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            Config.var_matching_files = True\r\n\r\n    else:\r\n        log_message = f\"No files matching the pattern were found. List of files found: {file_names}\"\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_file_check,\r\n            log_message,\r\n            Config.bronze_table,\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n        Config.var_matching_files = False\r\n\r\n\r\nreturn_df_row=[(0)]\r\nreturn_df = spark.createDataFrame(return_df_row,[\"return_df_row\"])\r\nreturn return_df",
            "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
            "scriptMethodFooter" : "    return out0"
          }
        },
        "6GW2xIOUUM3ticn79h-Ki$$DjAzJaowL8dswGYbaWw0S" : {
          "id" : "6GW2xIOUUM3ticn79h-Ki$$DjAzJaowL8dswGYbaWw0S",
          "component" : "Directory",
          "metadata" : {
            "label" : "Directory_Listing_1",
            "slug" : "Directory_Listing_1",
            "x" : 280,
            "y" : 220,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "dataPreview" : true
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "yQHKWPkn_RjNcgG-vQrpq$$kRYOpfpahJrYXn1QZdnBr",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "path" : "abfss://${var_raw_container}@${var_raw_storage_account}.dfs.core.windows.net${raw_file_path}",
            "includeSubDirs" : true,
            "filePattern" : "*.*"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/Directory",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "5tNPEDwi5D_iCPNBZuEhp$$G31mxEP4zDUWPzvP5FYqJ" : {
          "id" : "5tNPEDwi5D_iCPNBZuEhp$$G31mxEP4zDUWPzvP5FYqJ",
          "component" : "ControlFlowInput",
          "metadata" : {
            "label" : "TableIterator_Input_1",
            "slug" : "TableIterator_Input_1",
            "x" : 268.39996337890625,
            "y" : -100.79166870117189,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "visualProperty" : {
              "isHidden" : true
            }
          },
          "ports" : {
            "inputs" : [ {
              "id" : "v4WHOGi--JjSS1EhV1h3o$$XTUICRCq39DaoDAyY0Rrh",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "bronze_table",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the initial storage table for raw data.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "raw_file_path",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "File path where the raw data is stored.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_prefix",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Prefix used in naming the raw data files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "file_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Format of the raw data files, such as CSV or JSON.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "encryption_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Method used to encrypt the raw data files for security.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "field_separator",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Character used to separate fields in the dataset files.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "part_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file is a part of a larger file set.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "keys_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates if the file contains key information for processing.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "headers_in_file",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicates whether the file includes headers.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "full_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is a full load.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "inc_load",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if incremental loading is enabled for the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "critical",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Indicator of the dataset's importance or priority level.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "business_keys",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifiers used to distinguish records in the dataset.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tie_breaker_column",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Column used to resolve conflicts when multiple records have the same business keys.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "enabled",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Flag indicating if the dataset is currently active or operational.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ins_dtm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Timestamp when the record was inserted; Format is YYYY-MM-DD HH:MM:SS.",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "minNumberOfInPorts" : 1,
            "allowOutportAddDelete" : true,
            "description" : "",
            "allowInportAddDelete" : true,
            "minNumberOfOutPorts" : 0,
            "allowOutportRename" : true,
            "allowInportRename" : true
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/ControlFlowInput",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.51&projectSubscriptionProjectId=12654&path=gems/TableIterator",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "QPcbWs0jgVaYDG1zOKbYk$$zcwjXJhgxBGrx3mPkRFQE" : {
      "id" : "QPcbWs0jgVaYDG1zOKbYk$$zcwjXJhgxBGrx3mPkRFQE",
      "component" : "Script",
      "metadata" : {
        "label" : "set-start-time",
        "slug" : "set_start_time",
        "x" : 20,
        "y" : 520,
        "phase" : -1,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      },
      "properties" : {
        "script" : "import json\r\nimport sys\r\n\r\n # Set the timestamp as a configuration variable\r\nConfig.var_start_timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\r\n\r\n# Define default values for all parameters\r\ndefault_parameters = {\r\n    \"var_wkf_name\": \"executed from Prophecy\",\r\n    \"var_wkf_run_id\": \"executed from Prophecy-RunID\",\r\n    \"var_bus_dt\": \"20250507\",\r\n    \"var_bus_dt_dt\": \"2025-05-07\",\r\n    \"var_aux_min_dt\": \"1900-01-01\",\r\n    \"var_aux_max_dt\": \"9999-12-31\",\r\n    \"var_unspecified\": \"Unspecified\",\r\n    \"var_active\": \"Active\",\r\n    \"var_inactive\": \"Inactive\",\r\n    \"var_d_day_max_dt\": \"2200-12-31\",\r\n    \"var_src_sf\": \"1\",\r\n    \"var_src_hext\": \"2\",\r\n    \"var_src_hfin\": \"3\",\r\n    \"var_history_start_dt\": \"2018-08-01\",\r\n    \"var_full_load_flg\": \"0\",\r\n    \"var_inc_days_history\": \"7\",\r\n    \"var_catalog_name\": \"hrdp_catalog_dev\",\r\n    \"var_copper_schema\": \"copper\",\r\n    \"var_bronze_schema\": \"bronze\",\r\n    \"var_silver_schema\": \"silver\",\r\n    \"var_gold_schema\": \"gold\",\r\n    \"var_etl_schema\": \"etl\",\r\n    \"var_log_schema\": \"log\",\r\n    \"var_bus_dt_dt_end_of_month\": \"DUMMY\",\r\n    \"var_snapshot_init_load_bf\": \"DUMMY\",\r\n    \"var_snapshot_init_load_state\": \"DUMMY\"\r\n    }\r\n \r\n# Safely evaluate command-line arguments\r\ntry:\r\n    # Check if the -O flag is provided\r\n    if \"-O\" in sys.argv:\r\n        # Get the index of the -O flag and fetch the corresponding JSON string\r\n        argument_index = sys.argv.index(\"-O\") + 1\r\n        if argument_index < len(sys.argv):\r\n            argument = sys.argv[argument_index].strip()\r\n            if argument:\r\n                # Parse the JSON string\r\n                parameters = json.loads(argument)\r\n                print(f\"Parsed parameters: {parameters}\")\r\n            else:\r\n                # Empty argument provided\r\n                print(\"Empty argument detected after -O. Using default parameters.\")\r\n                parameters = default_parameters\r\n        else:\r\n            # No argument provided after -O\r\n            print(\"No argument provided after -O. Using default parameters.\")\r\n            parameters = default_parameters\r\n    else:\r\n        # No -O flag provided (likely running directly in Prophecy UI)\r\n        print(\"No -O flag detected. Using default parameters.\")\r\n        parameters = default_parameters\r\nexcept json.JSONDecodeError as e:\r\n    # JSON parsing error\r\n    print(f\"Error parsing JSON from arguments: {e}. Using default parameters.\")\r\n    parameters = default_parameters\r\nexcept Exception as e:\r\n    # General error\r\n    print(f\"Error processing arguments: {e}. Using default parameters.\")\r\n    parameters = default_parameters\r\n \r\n# Assign parameters to Config attributes\r\n\r\nConfig.var_bus_dt = parameters[\"var_bus_dt\"]\r\nConfig.var_bus_dt_dt = parameters[\"var_bus_dt_dt\"]\r\nConfig.var_aux_min_dt = parameters[\"var_aux_min_dt\"]\r\nConfig.var_aux_max_dt = parameters[\"var_aux_max_dt\"]\r\nConfig.var_unspecified = parameters[\"var_unspecified\"]\r\nConfig.var_active = parameters[\"var_active\"]\r\nConfig.var_inactive = parameters[\"var_inactive\"]\r\nConfig.var_d_day_max_dt = parameters[\"var_d_day_max_dt\"]\r\nConfig.var_src_sf = parameters[\"var_src_sf\"]\r\nConfig.var_src_hext = parameters[\"var_src_hext\"]\r\nConfig.var_src_hfin = parameters[\"var_src_hfin\"]\r\nConfig.var_history_start_dt = parameters[\"var_history_start_dt\"]\r\nConfig.var_full_load_flg = parameters[\"var_full_load_flg\"]\r\nConfig.var_inc_days_history = parameters[\"var_inc_days_history\"]\r\nConfig.var_catalog_name = parameters[\"var_catalog_name\"]\r\nConfig.var_copper_schema = parameters[\"var_copper_schema\"]\r\nConfig.var_bronze_schema = parameters[\"var_bronze_schema\"]\r\nConfig.var_silver_schema = parameters[\"var_silver_schema\"]\r\nConfig.var_gold_schema = parameters[\"var_gold_schema\"]\r\nConfig.var_etl_schema = parameters[\"var_etl_schema\"]\r\nConfig.var_log_schema = parameters[\"var_log_schema\"]\r\nConfig.var_wkf_run_id = parameters[\"var_wkf_run_id\"]\r\nConfig.var_wkf_name = parameters[\"var_wkf_name\"]\r\n\r\nConfig.var_bus_dt_dt_end_of_month = parameters[\"var_bus_dt_dt_end_of_month\"]\r\nConfig.var_snapshot_init_load_bf = parameters[\"var_snapshot_init_load_bf\"]\r\nConfig.var_snapshot_init_load_state = parameters[\"var_snapshot_init_load_state\"]\r\n\r\nConfig.var_task_name = \"tao_incremental_ingestion_csv\"\r\nConfig.var_task_run_id = \"\"\r\n\r\n#Config.var_default_schema = \"default\"\r\n\r\n#print(\"Config.var_tao_table_name:\", Config.var_tao_file_name)\r\n#print(\"Config.var_tao_table_name:\", Config.var_tao_table_name)\r\n\r\n#print(\"$var_tao_file_name:\", $var_tao_file_name)\r\n#print(\"$var_tao_table_name:\", $var_tao_table_name)\r\n\r\n#print(\"${var_tao_file_name}:\", ${var_tao_file_name})\r\n#print(\"${var_tao_table_name}:\", ${var_tao_table_name})\r\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession) -> None:",
        "scriptMethodFooter" : "    return "
      }
    },
    "SJpQq8z3rqKRIsUJpjLP4$$7DW6NPA1aBhNqOjB78VfE" : {
      "id" : "SJpQq8z3rqKRIsUJpjLP4$$7DW6NPA1aBhNqOjB78VfE",
      "component" : "Script",
      "metadata" : {
        "label" : "Critical_Files_Check",
        "slug" : "Critical_Files_Check",
        "x" : 20,
        "y" : 720,
        "phase" : 10,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      },
      "properties" : {
        "script" : "from pyspark.dbutils import DBUtils\r\n\r\ndbu = DBUtils(spark)\r\ncopper_log_table = f\"{Config.var_catalog_name}.{Config.var_log_container}.copper_load_log\"\r\ntao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_critical_file,\r\n        f\"Starting critical files check\",\r\n        None,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n)\r\n# Query sfic control table to retrieve rows where critical = 1\r\nresult_df = spark.sql(f\"SELECT bronze_table FROM {Config.var_catalog_name}.{Config.var_etl_schema}.tao_sfic_control_table_consolidated WHERE critical = 1\")\r\n\r\n# Columns to check\r\ncolumns_to_check = [Config.var_aux_extract_bus_date,Config.var_aux_updated_extract_bus_date] \r\n\r\n# Initialize a flag to track if all tables meet the condition\r\nall_tables_pass = True\r\n\r\nfor row in result_df.collect():\r\n    table_name = row[\"bronze_table\"]\r\n    \r\n    # Query the table and count records where the columns match the extract bus dt for sfic\r\n    # OR is not a performant operation but here should make no difference since we're just checking for the existence of 1 record\r\n    query = f\"SELECT COUNT(*) AS record_count FROM {Config.var_catalog_name}.{Config.var_copper_schema}.{table_name} WHERE {columns_to_check[0]} = {Config.var_extract_bus_dt_tao_sfic} OR {columns_to_check[1]} = {Config.var_extract_bus_dt_tao_sfic} LIMIT 1\"\r\n    try:\r\n        count_df = spark.sql(query)\r\n        record_count = count_df.collect()[0][\"record_count\"]  \r\n        if record_count == 0:\r\n            tao_custom_logger(\r\n                Config.var_error_type,\r\n                Config.var_critical_file,\r\n                f\"Table {table_name} failed the check. No records found for extract bus dt {Config.var_extract_bus_dt_tao_sfic}\",\r\n                {table_name},\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            \r\n            all_tables_pass = False\r\n            break  # Exit the loop early if a table fails the condition\r\n        else:\r\n            tao_custom_logger(\r\n                Config.var_info_type,\r\n                Config.var_critical_file,\r\n                f\"Table {table_name} passed the check with at least one matching record for extract bus dt {Config.var_extract_bus_dt_tao_sfic}\",\r\n                {table_name},\r\n                copper_log_table,\r\n                None,\r\n                None,\r\n                None,\r\n                None,\r\n                None\r\n            )\r\n            \r\n    except Exception as e:\r\n        tao_custom_logger(\r\n            Config.var_error_type,\r\n            Config.var_critical_file,\r\n            f\"Error querying table {table_name}: {str(e)}\",\r\n            {table_name},\r\n            copper_log_table,\r\n            None,\r\n            None,\r\n            None,\r\n            None,\r\n            None\r\n        )\r\n        \r\n       \r\n        all_tables_pass = False\r\n        break\r\n\r\nif all_tables_pass:\r\n    tao_custom_logger(\r\n        Config.var_info_type,\r\n        Config.var_critical_file,\r\n        f\"All tables passed the check\",\r\n        None,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n\r\n    dbu.jobs.taskValues.set(key = 'var_sfic_critical_pass', value = 1)\r\nelse:\r\n\r\n    tao_custom_logger(\r\n        Config.var_error_type,\r\n        Config.var_critical_file,\r\n        f\"One or more tables failed the check\",\r\n        None,\r\n        copper_log_table,\r\n        None,\r\n        None,\r\n        None,\r\n        None,\r\n        None\r\n    )\r\n    \r\n    dbu.jobs.taskValues.set(key = 'var_sfic_critical_pass', value = 0)",
        "scriptMethodHeader" : "def Script(spark: SparkSession) -> None:",
        "scriptMethodFooter" : "    return "
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  },
  "diagnostics" : [ {
    "property" : "$.workflow.processes.x9UaY2J7gSIcPt4uBIbug$$zeQIlSpGQSDcmCnNtrSNS.processes.Ihw6qJNZHYfJqVnx2vBW7$$fkb0JqiP-Qn3b8CZIXfW9.ports.outputs",
    "range" : {
      "start" : {
        "line" : 0,
        "character" : 0
      },
      "end" : {
        "line" : 0,
        "character" : 0
      }
    },
    "severity" : 3,
    "message" : "Please infer output schema from the cluster as described [here](https://docs.prophecy.io/low-code-spark/gems/custom/script/)",
    "tags" : [ ],
    "relatedInformation" : [ ],
    "diagnosticType" : 2
  } ]
}